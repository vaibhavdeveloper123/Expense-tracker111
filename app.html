 <!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4218914690424089" crossorigin="anonymous"></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Expense Tracker & AI Tools | Budget, Calculators, & Utilities</title>

    <meta name="description" content="Track expenses, plan budget, calculate EMI, BMI, SIP, GST, discount, age, interest, and compress images with the all-in-one smart finance & tools app. Perfect for money management, students, and families. 100% free, easy-to-use calculators and converters.">
    <meta name="keywords" content="expense tracker, EMI calculator, budget planner, SIP calculator, GST calculator, age calculator, BMI calculator, loan calculator, interest calculator, discount calculator, online tools, image compressor, base64 encoder, QR code generator, text to speech online, percentage calculator, financial calculator, monthly budget planner, track spending, best budget app, free expense manager, save money app, daily spending tracker, utility bill calculator, personal finance tool, budget for students, income tracker, grocery calculator, household expense manager, best finance app India, digital budget journal, fast budget calculator, smart finance dashboard, financial tools app, budget sheet maker, daily budget app, monthly savings calculator, finance tools online, track money app, finance planner for home, manage budget and expenses, investment calculator, simple budget tool, convert km to miles, image compression tool, convert image to base64, generate QR code online, free online finance tools, best free budgeting app, online expense book, financial analysis app, AI tools, AI text generator, AI chatbot, AI image generator, AI text summarizer, PDF maker, image to PDF">
    <meta name="author" content="ExpenseWise Team & vaibhav developer">
    <meta name="robots" content="index, follow">

    <meta property="og:title" content="Smart Expense Tracker & AI Tools | Budget & EMI Calculator" />
    <meta property="og:description" content="Track your expenses, manage budgets, calculate loans and interest, and use AI-powered tools for text, images, and documents with our all-in-one free app." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://yourwebsite.com" />
    <meta property="og:image" content="https://yourwebsite.com/assets/preview.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Smart Expense Tracker & AI Tools" />
    <meta name="twitter:description" content="Free tool to track income, expenses, and calculate budgets with interactive UI and analytics, plus powerful AI and utility tools." />
    <meta name="twitter:image" content="https://yourwebsite.com/assets/preview.png" />

    <link rel="icon" href="/favicon.ico" type="image/x-icon" />

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'Segoe UI', 'Tahoma', 'Geneva', 'Verdana', 'sans-serif'],
                    },
                    colors: {
                        primary: '#2D3B8E',
                        secondary: '#2CB9B0',
                        income: '#4CAF50',
                        expense: '#F44336',
                        light: '#F5F7FA',
                        dark: '#333',
                        gray: '#888',
                    },
                    boxShadow: {
                        'card-shadow': '0 4px 8px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LSJ4HEZLM2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-LSJ4HEZLM2');
    </script>

    <!-- React and ReactDOM CDNs -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transformation in browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- QRCode.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
    <!-- jsPDF CDN (loaded dynamically in PDFMaker component, but good to list here for awareness) -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script> -->

    <!-- Firebase CDNs - Must be loaded before the main script uses them -->
<script type='text/javascript' src='//pl27291027.profitableratecpm.com/fc/e5/55/fce5556dca10a258e3237293c5b492cf.js'></script>
https://www.profitableratecpm.com/d632qznpc?key=cc88095e41dc4fc3ab5bff4015324443
</head>
<body class="bg-gray-100 text-dark font-sans leading-relaxed">
    <div id="root"></div>

    <!-- Changed type to text/babel for JSX support -->
    <script type="text/babel">
        // Gemini API Key Slot
        const GEMINI_API_KEY = "AIzaSyDTd-nmZ6lNeUGitjL1_U3VS4BbPSjUZSs";
        // Access React hooks and ReactDOM from global scope
        const { useState, useEffect, useRef } = React;
        const { createRoot } = ReactDOM;

        // Custom Modal Component (replaces alert/confirm)
        function CustomModal({ isOpen, onClose, title, message, onConfirm, showConfirmButton = false }) {
            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000]">
                    <div className="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center">
                        <h3 className="text-xl font-bold text-gray-800 mb-4">{title}</h3>
                        <p className="text-gray-700 mb-6">{message}</p>
                        <div className="flex justify-center gap-4">
                            {showConfirmButton && (
                                <button
                                    onClick={onConfirm}
                                    className="bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition duration-200"
                                >
                                    Confirm
                                </button>
                            )}
                            <button
                                onClick={onClose}
                                className={`py-2 px-4 rounded-md transition duration-200 ${showConfirmButton ? 'bg-gray-200 text-gray-700 hover:bg-gray-300' : 'bg-blue-600 text-white hover:bg-blue-700'}`}
                            >
                                {showConfirmButton ? 'Cancel' : 'OK'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Main App Component
        function App() {
            const [selectedMainTab, setSelectedMainTab] = useState('transactions');
            const [transactions, setTransactions] = useState([]);
            const [budgets, setBudgets] = useState([]);
            const [groceryList, setGroceryList] = useState([]);
            const [currentCurrency, setCurrentCurrency] = useState('USD');

            
            // Modals
            const [isTransactionModalOpen, setIsTransactionModalOpen] = useState(false);
            const [transactionType, setTransactionType] = useState('expense');
            const [isBudgetModalOpen, setIsBudgetModalOpen] = useState(false);
            const [isGroceryModalOpen, setIsGroceryModalOpen] = useState(false);
            const [isConfirmationModalOpen, setIsConfirmationModalOpen] = useState(false);
            const [transactionToDeleteId, setTransactionToDeleteId] = useState(null);
            const [isToolModalOpen, setIsToolModalOpen] = useState(false);
            const [currentToolModal, setCurrentToolModal] = useState('');
            const [isCustomMessageModalOpen, setIsCustomMessageModalOpen] = useState(false);
            const [customMessageTitle, setCustomMessageTitle] = useState('');
            const [customMessageContent, setCustomMessageContent] = useState('');

            // Missing variables that were referenced but not defined
            const [firebaseError, setFirebaseError] = useState('');
            const [isAuthReady, setIsAuthReady] = useState(true); // Set to true since we're removing AI features

            
            
            const clearAllData = () => {
                if (confirm('Are you sure you want to clear all transactions, budgets, grocery lists, and settings?')) {
                    localStorage.removeItem('transactions');
                    localStorage.removeItem('budgets');
                    localStorage.removeItem('groceryList');
                    localStorage.removeItem('currency');
                    setTransactions([]);
                    setBudgets([]);
                    setGroceryList([]);
                    setCurrentCurrency('USD');
                    alert('All data has been cleared.');
                }
            };

            // --- Local Storage Functions (for Transactions, Budgets, Grocery List) ---
            useEffect(() => {
                const storedTransactions = JSON.parse(localStorage.getItem('transactions')) || [];
                const storedBudgets = JSON.parse(localStorage.getItem('budgets')) || [];
                const storedGrocery = JSON.parse(localStorage.getItem('groceryList')) || [];
                const storedCurrency = localStorage.getItem('currency') || 'USD';
                setTransactions(storedTransactions);
                setBudgets(storedBudgets);
                setGroceryList(storedGrocery);
                setCurrentCurrency(storedCurrency);
            }, []);

            const saveTransactionsToLocal = (newTransactions) => {
                setTransactions(newTransactions);
                localStorage.setItem('transactions', JSON.stringify(newTransactions));
            };

            const saveBudgetsToLocal = (newBudgets) => {
                setBudgets(newBudgets);
                localStorage.setItem('budgets', JSON.stringify(newBudgets));
            };

            const saveGroceryToLocal = (newGrocery) => {
                setGroceryList(newGrocery);
                localStorage.setItem('groceryList', JSON.stringify(newGrocery));
            };

            const saveCurrencyToLocal = (currency) => {
                setCurrentCurrency(currency);
                localStorage.setItem('currency', currency);
            };

            // Currency symbols and formatting
            const currencySymbols = {
                USD: '$', EUR: '‚Ç¨', GBP: '¬£', JPY: '¬•', CAD: '$', AUD: '$', INR: '‚Çπ', CNY: '¬•'
            };

            const formatCurrency = (amount) => {
                const symbol = currencySymbols[currentCurrency] || '$';
                return `${symbol}${amount.toFixed(2)}`;
            };

            // Handlers for modals
            const openTransactionModal = (type) => {
                setTransactionType(type);
                setIsTransactionModalOpen(true);
            };
            const closeTransactionModal = () => setIsTransactionModalOpen(false);

            const openBudgetModal = () => setIsBudgetModalOpen(true);
            const closeBudgetModal = () => setIsBudgetModalOpen(false);

            const openGroceryModal = () => setIsGroceryModalOpen(true);
            const closeGroceryModal = () => setIsGroceryModalOpen(false);

            const openConfirmationModal = (id) => {
                setTransactionToDeleteId(id);
                setIsConfirmationModalOpen(true);
            };
            const closeConfirmationModal = () => {
                setTransactionToDeleteId(null);
                setIsConfirmationModalOpen(false);
            };

            const handleToolModalOpen = (tool) => {
                setCurrentToolModal(tool);
                setIsToolModalOpen(true);
            };
            const handleToolModalClose = () => {
                setIsToolModalOpen(false);
                setCurrentToolModal('');
            };

            const showCustomMessage = (title, message) => {
                setCustomMessageTitle(title);
                setCustomMessageContent(message);
                setIsCustomMessageModalOpen(true);
            };
            const closeCustomMessageModal = () => {
                setIsCustomMessageModalOpen(false);
                setCustomMessageTitle('');
                setCustomMessageContent('');
            };

            // Main Tab Navigation
            const MainTab = ({ label, icon, tabId }) => (
                <button
                    onClick={() => setSelectedMainTab(tabId)}
                    className={`flex items-center space-x-2 py-2 px-5 rounded-full font-semibold text-base transition-all duration-300 ease-in-out
                        ${selectedMainTab === tabId
                            ? 'bg-blue-600 text-white shadow-lg transform scale-105'
                            : 'bg-gray-200 text-gray-700 hover:bg-blue-100 hover:text-blue-700'
                        }`}
                >
                    <span className="text-xl">{icon}</span>
                    <span>{label}</span>
                </button>
            );

            // Render logic for main content area
            const renderMainContent = () => {
                switch (selectedMainTab) {
                    case 'transactions':
                        return <TransactionsSection transactions={transactions} formatCurrency={formatCurrency} openConfirmationModal={openConfirmationModal} />;
                    case 'budgets':
                        return <BudgetsSection budgets={budgets} transactions={transactions} formatCurrency={formatCurrency} />;
                    case 'analytics':
                        return <AnalyticsSection transactions={transactions} />;
                    case 'calculators':
                        return <CalculatorsSection formatCurrency={formatCurrency} showCustomMessage={showCustomMessage} />;
                    case 'grocery':
                        return <GroceryListSection groceryList={groceryList} toggleGroceryItem={saveGroceryToLocal} removeGroceryItem={saveGroceryToLocal} />;
                    case 'tools':
                        return <UtilityToolsSection handleToolModalOpen={handleToolModalOpen} />;
                    default:
                        return <TransactionsSection transactions={transactions} formatCurrency={formatCurrency} openConfirmationModal={openConfirmationModal} />;
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex flex-col items-center p-4 font-sans text-gray-800">
                    <div className="bg-white p-8 rounded-xl shadow-2xl w-full max-w-5xl mb-8 border border-blue-100">
                        <header className="flex justify-between items-center pb-4 mb-6 border-b border-gray-200">
                            <div className="text-3xl font-bold text-primary">üí∞ ExpenseTracker</div>
                            <div className="flex items-center space-x-4">
                                <button onClick={clearAllData} className="p-2 bg-red-500 text-white rounded-md text-sm hover:bg-red-600 transition">Clear All</button>
                                <select
                                    className="p-2 border border-gray-300 rounded-md bg-white text-sm cursor-pointer focus:ring-2 focus:ring-blue-500"
                                    value={currentCurrency}
                                    onChange={(e) => {
                                        setCurrentCurrency(e.target.value);
                                        saveCurrencyToLocal(e.target.value);
                                    }}
                                >
                                    {Object.keys(currencySymbols).map(currency => (
                                        <option key={currency} value={currency}>{currency} ({currencySymbols[currency]})</option>
                                    ))}
                                </select>
                                <div className="w-10 h-10 rounded-full bg-secondary flex items-center justify-center text-white font-bold text-lg">üë§</div>
                            </div>
                        </header>

                        {firebaseError && (
                            <div className="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-center shadow-sm mb-6">
                                <p className="font-semibold">Firebase Error:</p>
                                <p>{firebaseError}</p>
                            </div>
                        )}

                        <BalanceCard transactions={transactions} formatCurrency={formatCurrency} />

                        <QuickActions
                            openTransactionModal={openTransactionModal}
                            openBudgetModal={openBudgetModal}
                            setSelectedMainTab={setSelectedMainTab}
                        />

                        {/* Main Navigation Tabs */}
                        <div className="flex flex-wrap justify-center gap-3 mb-8 border-b border-gray-200 pb-4">
                            <MainTab label="Transactions" icon="üí≥" tabId="transactions" />
                            <MainTab label="Budgets" icon="üìä" tabId="budgets" />
                            <MainTab label="Analytics" icon="üìà" tabId="analytics" />
                            <MainTab label="Calculators" icon="üßÆ" tabId="calculators" />
                            <MainTab label="Grocery List" icon="üõí" tabId="grocery" />
                            <MainTab label="Utility Tools" icon="üõ†Ô∏è" tabId="tools" />
                        </div>

                        {/* Render Main Content */}
                        <div className="w-full">
                            {renderMainContent()}
                        </div>
                    </div>

                    {/* Modals */}
                    <TransactionModal
                        isOpen={isTransactionModalOpen}
                        onClose={closeTransactionModal}
                        transactionType={transactionType}
                        setTransactionType={setTransactionType}
                        saveTransactionsToLocal={saveTransactionsToLocal}
                        showCustomMessage={showCustomMessage}
                    />
                    <BudgetModal
                        isOpen={isBudgetModalOpen}
                        onClose={closeBudgetModal}
                        saveBudgetsToLocal={saveBudgetsToLocal}
                        showCustomMessage={showCustomMessage}
                    />
                    <GroceryModal
                        isOpen={isGroceryModalOpen}
                        onClose={closeGroceryModal}
                        saveGroceryToLocal={saveGroceryToLocal}
                        showCustomMessage={showCustomMessage}
                    />
                    <ConfirmationModal
                        isOpen={isConfirmationModalOpen}
                        onClose={closeConfirmationModal}
                        onConfirm={() => {
                            saveTransactionsToLocal(transactions.filter(t => t.id !== transactionToDeleteId));
                            closeConfirmationModal();
                        }}
                    />
                    <ToolModal
                        isOpen={isToolModalOpen}
                        onClose={handleToolModalClose}
                        currentTool={currentToolModal}
                        isAuthReady={isAuthReady}
                        showCustomMessage={showCustomMessage}
                    />
                    <CustomModal
                        isOpen={isCustomMessageModalOpen}
                        onClose={closeCustomMessageModal}
                        title={customMessageTitle}
                        message={customMessageContent}
                    />

                    {/* Powered by Footer */}
                    <footer className="mt-8 text-center text-gray-600 text-sm">
                        Powered by <span className="font-semibold text-blue-700">'vaibhav developer'</span>
                    </footer>
                </div>
            );
        }

        // --- Individual Components ---

        function BalanceCard({ transactions, formatCurrency }) {
            const totalIncome = transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
            const totalExpenses = transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
            const totalBalance = totalIncome - totalExpenses;

            return (
                <div className="bg-gradient-to-r from-primary to-secondary text-white rounded-xl p-6 mb-6 shadow-lg">
                    <div className="text-lg opacity-90 mb-2">Total Balance</div>
                    <div className="text-4xl font-bold mb-5">{formatCurrency(totalBalance)}</div>
                    <div className="flex justify-between flex-wrap gap-4">
                        <div className="text-center flex-1 min-w-[120px]">
                            <i className="fas fa-arrow-up text-income text-2xl mb-1"></i>
                            <div className="font-bold text-xl">{formatCurrency(totalIncome)}</div>
                            <div className="text-sm opacity-80">Income üí∞</div>
                        </div>
                        <div className="text-center flex-1 min-w-[120px]">
                            <i className="fas fa-arrow-down text-expense text-2xl mb-1"></i>
                            <div className="font-bold text-xl">{formatCurrency(totalExpenses)}</div>
                            <div className="text-sm opacity-80">Expenses üí∏</div>
                        </div>
                    </div>
                </div>
            );
        }

        function QuickActions({ openTransactionModal, openBudgetModal, setSelectedMainTab }) {
            return (
                <div className="grid grid-cols-2 sm:grid-cols-3 gap-4 mb-6">
                    <button onClick={() => openTransactionModal('expense')} className="action-btn bg-white rounded-xl p-4 flex flex-col items-center justify-center shadow-card-shadow hover:translate-y-[-3px] transition-transform duration-200">
                        <i className="fas fa-minus-circle text-primary text-3xl mb-2"></i>
                        <span className="text-sm font-medium">Add Expense ‚ûñ</span>
                    </button>
                    <button onClick={() => openTransactionModal('income')} className="action-btn bg-white rounded-xl p-4 flex flex-col items-center justify-center shadow-card-shadow hover:translate-y-[-3px] transition-transform duration-200">
                        <i className="fas fa-plus-circle text-primary text-3xl mb-2"></i>
                        <span className="text-sm font-medium">Add Income ‚ûï</span>
                    </button>
                    <button onClick={openBudgetModal} className="action-btn bg-white rounded-xl p-4 flex flex-col items-center justify-center shadow-card-shadow hover:translate-y-[-3px] transition-transform duration-200">
                        <i className="fas fa-wallet text-primary text-3xl mb-2"></i>
                        <span className="text-sm font-medium">Set Budget üí∞</span>
                    </button>
                    <button onClick={() => setSelectedMainTab('calculators')} className="action-btn bg-white rounded-xl p-4 flex flex-col items-center justify-center shadow-card-shadow hover:translate-y-[-3px] transition-transform duration-200">
                        <i className="fas fa-calculator text-primary text-3xl mb-2"></i>
                        <span className="text-sm font-medium">Calculators üßÆ</span>
                    </button>
                    <button onClick={() => setSelectedMainTab('grocery')} className="action-btn bg-white rounded-xl p-4 flex flex-col items-center justify-center shadow-card-shadow hover:translate-y-[-3px] transition-transform duration-200">
                        <i className="fas fa-shopping-basket text-primary text-3xl mb-2"></i>
                        <span className="text-sm font-medium">Grocery List üõí</span>
                    </button>
                    <button onClick={() => setSelectedMainTab('tools')} className="action-btn bg-white rounded-xl p-4 flex flex-col items-center justify-center shadow-card-shadow hover:translate-y-[-3px] transition-transform duration-200">
                        <i className="fas fa-tools text-primary text-3xl mb-2"></i>
                        <span className="text-sm font-medium">More Tools üõ†Ô∏è</span>
                    </button>
                </div>
            );
        }

        function TransactionsSection({ transactions, formatCurrency, openConfirmationModal }) {
            const sortedTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date));

            const getCategoryIcon = (category) => {
                switch (category) {
                    case 'food': return 'üçî';
                    case 'transport': return 'üöó';
                    case 'shopping': return 'üõçÔ∏è';
                    case 'housing': return 'üè†';
                    case 'entertainment': return 'üé¨';
                    case 'salary': return 'üíº';
                    default: return '‚ú®';
                }
            };

            return (
                <div className="bg-white rounded-xl p-6 shadow-card-shadow mb-6">
                    <div className="flex justify-between items-center mb-4">
                        <h2 className="text-xl font-semibold text-gray-800">Recent Transactions</h2>
                        <span className="text-primary text-sm cursor-pointer hover:underline">See All üëâ</span>
                    </div>
                    <div className="transactions-list">
                        {transactions.length === 0 ? (
                            <div className="text-center text-gray-500 py-4">üì≠ No transactions yet. Add your first transaction!</div>
                        ) : (
                            sortedTransactions.slice(0, 5).map(transaction => (
                                <div key={transaction.id} className="flex justify-between items-center py-3 border-b border-gray-100 last:border-b-0">
                                    <div className="flex items-center">
                                        <div className={`w-10 h-10 rounded-full flex items-center justify-center mr-4 text-xl
                                            ${transaction.type === 'income' ? 'bg-green-100 text-green-600' : 'bg-red-100 text-red-600'}`}>
                                            <i className={`fas fa-${transaction.type === 'income' ? 'plus' : 'minus'}`}></i>
                                        </div>
                                        <div>
                                            <h4 className="font-medium text-gray-800">{transaction.description}</h4>
                                            <p className="text-sm text-gray-500">{new Date(transaction.date).toLocaleDateString()}</p>
                                        </div>
                                    </div>
                                    <div className="flex items-center">
                                        <span className={`font-semibold text-lg ${transaction.type === 'income' ? 'text-income' : 'text-expense'}`}>
                                            {formatCurrency(transaction.amount)}
                                        </span>
                                        <button onClick={() => openConfirmationModal(transaction.id)} className="ml-4 text-gray-400 hover:text-red-500 transition-colors duration-200">
                                            <i className="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                            ))
                        )}
                    </div>
                </div>
            );
        }

        function BudgetsSection({ budgets, transactions, formatCurrency }) {
            const getCategoryIcon = (category) => {
                switch (category) {
                    case 'food': return 'üçî';
                    case 'transport': return 'üöó';
                    case 'shopping': return 'üõçÔ∏è';
                    case 'housing': return 'üè†';
                    case 'entertainment': return 'üé¨';
                    default: return 'üí∞';
                }
            };

            return (
                <div className="bg-white rounded-xl p-6 shadow-card-shadow mb-6">
                    <div className="flex justify-between items-center mb-4">
                        <h2 className="text-xl font-semibold text-gray-800">Monthly Budgets</h2>
                        <span className="text-primary text-sm cursor-pointer hover:underline">See All üëâ</span>
                    </div>
                    <div className="budget-card">
                        {budgets.length === 0 ? (
                            <div className="text-center text-gray-500 py-4">üì≠ No budgets set up yet. Create your first budget!</div>
                        ) : (
                            budgets.map(budget => {
                                const spent = transactions
                                    .filter(t => t.type === 'expense' && t.category === budget.category)
                                    .reduce((sum, t) => sum + t.amount, 0);
                                const percentage = (spent / budget.budget) * 100;
                                let progressClass = '';
                                if (percentage > 90) {
                                    progressClass = 'bg-expense';
                                } else if (percentage > 70) {
                                    progressClass = 'bg-yellow-500';
                                } else {
                                    progressClass = 'bg-secondary';
                                }

                                return (
                                    <div key={budget.id} className="budget-item mb-4 last:mb-0">
                                        <div className="flex justify-between items-center mb-2">
                                            <div className="flex items-center text-gray-800">
                                                <span className="text-2xl mr-2">{getCategoryIcon(budget.category)}</span>
                                                <h4 className="font-medium">{budget.category.charAt(0).toUpperCase() + budget.category.slice(1)}</h4>
                                            </div>
                                            <span className="font-semibold text-lg">
                                                {formatCurrency(spent)} / {formatCurrency(budget.budget)}
                                            </span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-2.5">
                                            <div className={`h-2.5 rounded-full ${progressClass}`} style={{ width: `${Math.min(100, percentage)}%` }}></div>
                                        </div>
                                        <div className="flex justify-between text-xs text-gray-500 mt-1">
                                            <span>{percentage.toFixed(1)}% Used</span>
                                            <span>Remaining: {formatCurrency(budget.budget - spent)}</span>
                                        </div>
                                    </div>
                                );
                            })
                        )}
                    </div>
                </div>
            );
        }

        function AnalyticsSection({ transactions }) {
            const spendingChartRef = useRef(null);
            const categoryChartRef = useRef(null);
            let spendingChartInstance = useRef(null);
            let categoryChartInstance = useRef(null);

            useEffect(() => {
                if (spendingChartInstance.current) {
                    spendingChartInstance.current.destroy();
                }
                if (categoryChartInstance.current) {
                    categoryChartInstance.current.destroy();
                }

                const spendingCtx = spendingChartRef.current.getContext('2d');
                spendingChartInstance.current = new Chart(spendingCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Net Balance',
                            data: [],
                            borderColor: 'rgb(45, 59, 142)', // primary color
                            tension: 0.1,
                            fill: false,
                            pointBackgroundColor: 'rgb(45, 59, 142)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(45, 59, 142)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                            }
                        },
                        scales: {
                            x: {
                                type: 'time', // Use time scale for dates
                                time: {
                                    unit: 'day',
                                    tooltipFormat: 'MMM D, YYYY',
                                    displayFormats: {
                                        day: 'MMM D'
                                    }
                                },
                                title: {
                                    display: true,
                                    text: 'Date'
                                }
                            },
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Amount'
                                }
                            }
                        }
                    }
                });

                const categoryCtx = categoryChartRef.current.getContext('2d');
                categoryChartInstance.current = new Chart(categoryCtx, {
                    type: 'pie',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#E7E9ED', '#8B0000', '#008000', '#4682B4']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right',
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed !== null) {
                                            label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed); // Placeholder currency
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });

                updateCharts();

                return () => {
                    if (spendingChartInstance.current) {
                        spendingChartInstance.current.destroy();
                    }
                    if (categoryChartInstance.current) {
                        categoryChartInstance.current.destroy();
                    }
                };
            }, [transactions]); // Re-initialize charts if transactions change

            const updateCharts = () => {
                // Spending Chart
                const dailyBalances = {};
                transactions.forEach(t => {
                    const date = new Date(t.date).toISOString().split('T')[0]; // YYYY-MM-DD for consistent sorting
                    if (!dailyBalances[date]) {
                        dailyBalances[date] = 0;
                    }
                    dailyBalances[date] += (t.type === 'income' ? t.amount : -t.amount);
                });

                const sortedDates = Object.keys(dailyBalances).sort();
                let runningBalance = 0;
                const balanceData = sortedDates.map(date => {
                    runningBalance += dailyBalances[date];
                    return { x: date, y: runningBalance };
                });

                spendingChartInstance.current.data.labels = sortedDates;
                spendingChartInstance.current.data.datasets[0].data = balanceData;
                spendingChartInstance.current.update();

                // Category Chart
                const categorySpending = {};
                transactions
                    .filter(t => t.type === 'expense')
                    .forEach(t => {
                        if (!categorySpending[t.category]) {
                            categorySpending[t.category] = 0;
                        }
                        categorySpending[t.category] += t.amount;
                    });

                categoryChartInstance.current.data.labels = Object.keys(categorySpending);
                categoryChartInstance.current.data.datasets[0].data = Object.values(categorySpending);
                categoryChartInstance.current.update();
            };

            return (
                <div className="bg-white rounded-xl p-6 shadow-card-shadow mb-6">
                    <h2 className="text-xl font-semibold text-gray-800 mb-4">Spending Analytics</h2>
                    <div className="h-64 mb-6">
                        <canvas ref={spendingChartRef}></canvas>
                    </div>
                    <h2 className="text-xl font-semibold text-gray-800 mb-4">Category Breakdown</h2>
                    <div className="h-64">
                        <canvas ref={categoryChartRef}></canvas>
                    </div>
                </div>
            );
        }

        function CalculatorsSection({ formatCurrency, showCustomMessage }) {
            const [selectedCalculator, setSelectedCalculator] = useState('emi');

            // EMI Calculator
            const [loanAmount, setLoanAmount] = useState('');
            const [interestRateEMI, setInterestRateEMI] = useState('');
            const [loanTenure, setLoanTenure] = useState('');
            const [emiResult, setEmiResult] = useState('');

            const calculateEMI = () => {
                const amount = parseFloat(loanAmount);
                const interest = parseFloat(interestRateEMI) / 100 / 12;
                const tenure = parseInt(loanTenure);

                if (isNaN(amount) || isNaN(interest) || isNaN(tenure) || amount <= 0 || interest <= 0 || tenure <= 0) {
                    setEmiResult('<p class="text-red-600">Please enter valid positive numbers for all fields.</p>');
                    return;
                }

                const emi = amount * interest * Math.pow((1 + interest), tenure) / (Math.pow((1 + interest), tenure) - 1);
                setEmiResult(`<p>Monthly EMI: <strong class="text-blue-600">${formatCurrency(emi)}</strong></p>`);
            };

            // Percentage Calculator
            const [percentageValue, setPercentageValue] = useState('');
            const [percentageRate, setPercentageRate] = useState('');
            const [percentageResult, setPercentageResult] = useState('');

            const calculatePercentage = () => {
                const value = parseFloat(percentageValue);
                const percentage = parseFloat(percentageRate);

                if (isNaN(value) || isNaN(percentage)) {
                    setPercentageResult('<p class="text-red-600">Please enter valid numbers for both fields.</p>');
                    return;
                }

                const result = (value * percentage) / 100;
                setPercentageResult(`<p>${percentage}% of ${value} is <strong class="text-blue-600">${result.toFixed(2)}</strong></p>`);
            };

            // Interest Calculator (Simple Interest)
            const [principalAmount, setPrincipalAmount] = useState('');
            const [interestRateSimple, setInterestRateSimple] = useState('');
            const [timePeriod, setTimePeriod] = useState('');
            const [interestResult, setInterestResult] = useState('');

            const calculateInterest = () => {
                const principal = parseFloat(principalAmount);
                const rate = parseFloat(interestRateSimple) / 100;
                const time = parseFloat(timePeriod);

                if (isNaN(principal) || isNaN(rate) || isNaN(time) || principal <= 0 || rate < 0 || time <= 0) {
                    setInterestResult('<p class="text-red-600">Please enter valid positive numbers for all fields.</p>');
                    return;
                }

                const simpleInterest = principal * rate * time;
                const totalAmount = principal + simpleInterest;
                setInterestResult(`
                    <p>Simple Interest: <strong class="text-blue-600">${formatCurrency(simpleInterest)}</strong></p>
                    <p>Total Amount: <strong class="text-blue-600">${formatCurrency(totalAmount)}</strong></p>
                `);
            };

            return (
                <div className="bg-white rounded-xl p-6 shadow-card-shadow mb-6">
                    <h2 className="text-xl font-semibold text-gray-800 mb-4">Financial Calculators üßÆ</h2>
                    <div className="flex border-b border-gray-200 mb-4">
                        <button onClick={() => setSelectedCalculator('emi')} className={`py-2 px-4 font-medium transition-colors duration-200 ${selectedCalculator === 'emi' ? 'text-primary border-b-2 border-primary' : 'text-gray-600 hover:text-primary'}`}>üè¶ EMI</button>
                        <button onClick={() => setSelectedCalculator('percentage')} className={`py-2 px-4 font-medium transition-colors duration-200 ${selectedCalculator === 'percentage' ? 'text-primary border-b-2 border-primary' : 'text-gray-600 hover:text-primary'}`}>% Percentage</button>
                        <button onClick={() => setSelectedCalculator('interest')} className={`py-2 px-4 font-medium transition-colors duration-200 ${selectedCalculator === 'interest' ? 'text-primary border-b-2 border-primary' : 'text-gray-600 hover:text-primary'}`}>üíµ Interest</button>
                    </div>

                    {selectedCalculator === 'emi' && (
                        <div id="emi-calculator" className="space-y-4">
                            <div className="form-group">
                                <label htmlFor="loan-amount" className="block text-gray-700 text-sm font-medium mb-1">üí∞ Loan Amount</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="loan-amount" placeholder="e.g. 100000" type="number" value={loanAmount} onChange={(e) => setLoanAmount(e.target.value)} />
                            </div>
                            <div className="form-group">
                                <label htmlFor="interest-rate" className="block text-gray-700 text-sm font-medium mb-1">üìà Interest Rate (% p.a.)</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="interest-rate" placeholder="e.g. 8.5" type="number" value={interestRateEMI} onChange={(e) => setInterestRateEMI(e.target.value)} />
                            </div>
                            <div className="form-group">
                                <label htmlFor="loan-tenure" className="block text-gray-700 text-sm font-medium mb-1">‚è≥ Loan Tenure (months)</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="loan-tenure" placeholder="e.g. 60" type="number" value={loanTenure} onChange={(e) => setLoanTenure(e.target.value)} />
                            </div>
                            <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateEMI}>üßÆ Calculate EMI</button>
                            <div className="p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: emiResult }}></div>
                        </div>
                    )}
                    {selectedCalculator === 'percentage' && (
                        <div id="percentage-calculator" className="space-y-4">
                            <div className="form-group">
                                <label htmlFor="percentage-value" className="block text-gray-700 text-sm font-medium mb-1">üî¢ Value</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="percentage-value" placeholder="e.g. 100" type="number" value={percentageValue} onChange={(e) => setPercentageValue(e.target.value)} />
                            </div>
                            <div className="form-group">
                                <label htmlFor="percentage" className="block text-gray-700 text-sm font-medium mb-1">% Percentage</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="percentage" placeholder="e.g. 15" type="number" value={percentageRate} onChange={(e) => setPercentageRate(e.target.value)} />
                            </div>
                            <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculatePercentage}>üßÆ Calculate</button>
                            <div className="p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: percentageResult }}></div>
                        </div>
                    )}
                    {selectedCalculator === 'interest' && (
                        <div id="interest-calculator" className="space-y-4">
                            <div className="form-group">
                                <label htmlFor="principal-amount" className="block text-gray-700 text-sm font-medium mb-1">üí∞ Principal Amount</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="principal-amount" placeholder="e.g. 10000" type="number" value={principalAmount} onChange={(e) => setPrincipalAmount(e.target.value)} />
                            </div>
                            <div className="form-group">
                                <label htmlFor="interest-rate-simple" className="block text-gray-700 text-sm font-medium mb-1">üìà Interest Rate (% p.a.)</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="interest-rate-simple" placeholder="e.g. 5" type="number" value={interestRateSimple} onChange={(e) => setInterestRateSimple(e.target.value)} />
                            </div>
                            <div className="form-group">
                                <label htmlFor="time-period" className="block text-gray-700 text-sm font-medium mb-1">‚è≥ Time Period (years)</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="time-period" placeholder="e.g. 3" type="number" value={timePeriod} onChange={(e) => setTimePeriod(e.target.value)} />
                            </div>
                            <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateInterest}>üßÆ Calculate Interest</button>
                            <div className="p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: interestResult }}></div>
                        </div>
                    )}
                </div>
            );
        }

        function GroceryListSection({ groceryList, toggleGroceryItem, removeGroceryItem }) {
            return (
                <div className="bg-white rounded-xl p-6 shadow-card-shadow mb-6">
                    <div className="flex justify-between items-center mb-4">
                        <h2 className="text-xl font-semibold text-gray-800">üõí Grocery List</h2>
                        <button onClick={() => document.getElementById('grocery-modal').style.display = 'flex'} className="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 text-sm font-semibold">
                            <i className="fas fa-plus mr-2"></i> Add Item
                        </button>
                    </div>
                    <div className="grocery-list">
                        {groceryList.length === 0 ? (
                            <div className="text-center text-gray-500 py-4">üõçÔ∏è Your grocery list is empty. Add some items!</div>
                        ) : (
                            groceryList.map(item => (
                                <div key={item.id} className="flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0">
                                    <div className="flex items-center">
                                        <input
                                            type="checkbox"
                                            checked={item.completed}
                                            onChange={() => toggleGroceryItem(item.id, { completed: !item.completed })}
                                            className="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500 mr-3"
                                        />
                                        <span className={`text-gray-800 ${item.completed ? 'line-through text-gray-500' : ''}`}>
                                            {item.name}
                                        </span>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="text-sm text-gray-500 mr-4">{item.quantity}</span>
                                        <button onClick={() => removeGroceryItem(item.id)} className="text-gray-400 hover:text-red-500 transition-colors duration-200">
                                            <i className="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                            ))
                        )}
                    </div>
                </div>
            );
        }

        function UtilityToolsSection({ handleToolModalOpen }) {
            const tools = [
                { id: 'color-palette', icon: 'üé®', name: 'Color Palette Generator', description: 'Generate beautiful color schemes' },
                { id: 'lorem-ipsum', icon: 'üìù', name: 'Lorem Ipsum Generator', description: 'Generate placeholder text' },
                { id: 'hash-generator', icon: 'üîê', name: 'Hash Generator', description: 'Generate MD5, SHA1, SHA256 hashes' },
                { id: 'json-formatter', icon: 'üìã', name: 'JSON Formatter', description: 'Format and validate JSON' },
                { id: 'image-compressor', icon: 'üìè', name: 'Image Compressor', description: 'Reduce image file size' },
                { id: 'pdf-maker', icon: 'üìÑ', name: 'PDF Maker', description: 'Create PDF from text/images' },
                { id: 'bmi', icon: '‚öñÔ∏è', name: 'BMI Calculator', description: 'Calculate Body Mass Index' },
                { id: 'age', icon: 'üéÇ', name: 'Age Calculator', description: 'Calculate exact age' },
                { id: 'discount', icon: 'üè∑Ô∏è', name: 'Discount Calc', description: 'Calculate final price' },
                { id: 'gst', icon: 'üßæ', name: 'GST Calculator', description: 'Calculate GST amount' },
                { id: 'sip', icon: 'üìà', name: 'SIP Calculator', description: 'Calculate SIP returns' },
                { id: 'qrcode', icon: 'üì±', name: 'QR Generator', description: 'Generate QR codes' },
                { id: 'tts', icon: 'üîä', name: 'Text to Speech', description: 'Convert text to audio' },
                { id: 'unit', icon: '‚ÜîÔ∏è', name: 'Unit Converter', description: 'Convert km to miles' },
                { id: 'base64', icon: 'üñºÔ∏è', name: 'Base64 Encoder', description: 'Convert image to Base64' },
                { id: 'password-generator', icon: 'üîë', name: 'Password Generator', description: 'Create strong passwords' },
                { id: 'currency-converter', icon: 'üíµ', name: 'Currency Converter', description: 'Convert between currencies' },
                { id: 'electricity', icon: '‚ö°', name: 'Electricity Bill', description: 'Calculate electricity costs' },
                { id: 'water', icon: 'üíß', name: 'Water Intake', description: 'Calculate daily water needs' },
                { id: 'sleep', icon: 'üåô', name: 'Sleep Calculator', description: 'Find optimal bedtimes' },
                { id: 'tip', icon: 'üçΩÔ∏è', name: 'Tip Calculator', description: 'Calculate tips easily' },
                { id: 'video-converter', icon: 'üé•', name: 'Video to MP3', description: 'Convert video to audio or compress' },
                { id: 'image-to-text', icon: 'üÖ∞Ô∏è', name: 'Image to Text (OCR)', description: 'Extract text from images' },
                { id: 'file-converter', icon: 'üîÑ', name: 'File Converter', description: 'Convert between various file types' },
            ];

            return (
                <div className="bg-white rounded-xl p-6 shadow-card-shadow mb-6">
                    <h2 className="text-xl font-semibold text-gray-800 mb-4">üõ†Ô∏è Utility Tools</h2>
                    <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                        {tools.map(tool => (
                            <button key={tool.id} onClick={() => handleToolModalOpen(tool.id)} className="tool-card bg-light rounded-xl p-4 text-center cursor-pointer transition-all duration-300 hover:translate-y-[-5px] hover:shadow-lg border border-gray-200">
                                <span className="text-3xl mb-2 block">{tool.icon}</span>
                                <h3 className="font-semibold text-gray-800 text-base mb-1">{tool.name}</h3>
                                <p className="text-gray-500 text-xs">{tool.description}</p>
                            </button>
                        ))}
                    </div>
                </div>
            );
        }

        // --- Modals for Tools ---
        function ToolModal({ isOpen, onClose, currentTool, isAuthReady, showCustomMessage }) {
            if (!isOpen) return null;

            const renderToolContent = () => {
                switch (currentTool) {
                    case 'color-palette': return <ColorPaletteGenerator showCustomMessage={showCustomMessage} />;
                    case 'lorem-ipsum': return <LoremIpsumGenerator showCustomMessage={showCustomMessage} />;
                    case 'hash-generator': return <HashGenerator showCustomMessage={showCustomMessage} />;
                    case 'json-formatter': return <JSONFormatter showCustomMessage={showCustomMessage} />;
                    case 'image-compressor': return <ImageCompressor showCustomMessage={showCustomMessage} />;
                    case 'pdf-maker': return <PDFMaker showCustomMessage={showCustomMessage} />;
                    case 'bmi': return <BMICalculator showCustomMessage={showCustomMessage} />;
                    case 'age': return <AgeCalculator showCustomMessage={showCustomMessage} />;
                    case 'discount': return <DiscountCalculator showCustomMessage={showCustomMessage} />;
                    case 'gst': return <GSTCalculator showCustomMessage={showCustomMessage} />;
                    case 'sip': return <SIPCalculator showCustomMessage={showCustomMessage} />;
                    case 'qrcode': return <QRCodeGenerator showCustomMessage={showCustomMessage} />;
                    case 'tts': return <TextToSpeech showCustomMessage={showCustomMessage} />;
                    case 'unit': return <UnitConverter showCustomMessage={showCustomMessage} />;
                    case 'base64': return <Base64Encoder showCustomMessage={showCustomMessage} />;
                    case 'password-generator': return <PasswordGenerator showCustomMessage={showCustomMessage} />;
                    case 'currency-converter': return <CurrencyConverter showCustomMessage={showCustomMessage} />;
                    case 'electricity': return <ElectricityBillCalculator showCustomMessage={showCustomMessage} />;
                    case 'water': return <WaterIntakeCalculator showCustomMessage={showCustomMessage} />;
                    case 'sleep': return <SleepCalculator showCustomMessage={showCustomMessage} />;
                    case 'tip': return <TipCalculator showCustomMessage={showCustomMessage} />;
                    case 'pdf-tools': return <PDFToolsPlaceholder showCustomMessage={showCustomMessage} />; // Placeholder
                    case 'video-converter': return <VideoConverterPlaceholder showCustomMessage={showCustomMessage} />; // Placeholder
                    case 'image-to-text': return <ImageToTextOCRPlaceholder showCustomMessage={showCustomMessage} />; // Placeholder
                    case 'file-converter': return <FileConverterPlaceholder showCustomMessage={showCustomMessage} />; // Placeholder
                    default: return <div className="text-center text-gray-500">Tool not found.</div>;
                }
            };

            const getToolTitle = (toolKey) => {
                const toolsMap = {
                    'color-palette': 'Color Palette Generator',
                    'lorem-ipsum': 'Lorem Ipsum Generator',
                    'hash-generator': 'Hash Generator',
                    'json-formatter': 'JSON Formatter',
                    'image-compressor': 'Image Compressor',
                    'pdf-maker': 'PDF Maker',
                    'bmi': 'BMI Calculator',
                    'age': 'Age Calculator',
                    'discount': 'Discount Calculator',
                    'gst': 'GST Calculator',
                    'sip': 'SIP Calculator',
                    'qrcode': 'QR Code Generator',
                    'tts': 'Text to Speech',
                    'unit': 'Unit Converter (KM to Miles)',
                    'base64': 'Base64 Encoder (Image)',
                    'password-generator': 'Password Generator',
                    'currency-converter': 'Currency Converter',
                    'electricity': 'Electricity Bill Calculator',
                    'water': 'Water Intake Calculator',
                    'sleep': 'Sleep Cycle Calculator',
                    'tip': 'Tip Calculator',
                    'pdf-tools': 'PDF Tools',
                    'video-converter': 'Video to MP3 Converter / Compressor',
                    'image-to-text': 'Image to Text (OCR)',
                    'file-converter': 'All-in-One File Converter',
                };
                return toolsMap[toolKey] || 'Tool';
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] p-4">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transform scale-100 transition-transform duration-300 ease-in-out">
                        <div className="flex justify-between items-center p-6 border-b border-gray-200">
                            <h3 className="text-2xl font-bold text-gray-800">{getToolTitle(currentTool)}</h3>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-800 text-3xl font-light leading-none">√ó</button>
                        </div>
                        <div className="p-6">
                            {renderToolContent()}
                        </div>
                    </div>
                </div>
            );
        }

        // --- New Offline Tools Components ---
        function ColorPaletteGenerator({ showCustomMessage }) {
            const [baseColor, setBaseColor] = useState('#3B82F6');
            const [paletteType, setPaletteType] = useState('complementary');
            const [generatedPalette, setGeneratedPalette] = useState([]);

            const generatePalette = () => {
                const hex = baseColor.replace('#', '');
                const r = parseInt(hex.substr(0, 2), 16);
                const g = parseInt(hex.substr(2, 2), 16);
                const b = parseInt(hex.substr(4, 2), 16);

                let palette = [baseColor];

                switch (paletteType) {
                    case 'complementary':
                        palette.push(`#${(255-r).toString(16).padStart(2,'0')}${(255-g).toString(16).padStart(2,'0')}${(255-b).toString(16).padStart(2,'0')}`);
                        break;
                    case 'triadic':
                        palette.push(`#${g.toString(16).padStart(2,'0')}${b.toString(16).padStart(2,'0')}${r.toString(16).padStart(2,'0')}`);
                        palette.push(`#${b.toString(16).padStart(2,'0')}${r.toString(16).padStart(2,'0')}${g.toString(16).padStart(2,'0')}`);
                        break;
                    case 'analogous':
                        for (let i = 1; i <= 4; i++) {
                            const newR = Math.min(255, Math.max(0, r + (i * 30)));
                            const newG = Math.min(255, Math.max(0, g + (i * 20)));
                            const newB = Math.min(255, Math.max(0, b + (i * 10)));
                            palette.push(`#${newR.toString(16).padStart(2,'0')}${newG.toString(16).padStart(2,'0')}${newB.toString(16).padStart(2,'0')}`);
                        }
                        break;
                    case 'monochromatic':
                        for (let i = 1; i <= 4; i++) {
                            const factor = 1 - (i * 0.2);
                            const newR = Math.round(r * factor);
                            const newG = Math.round(g * factor);
                            const newB = Math.round(b * factor);
                            palette.push(`#${newR.toString(16).padStart(2,'0')}${newG.toString(16).padStart(2,'0')}${newB.toString(16).padStart(2,'0')}`);
                        }
                        break;
                }

                setGeneratedPalette(palette);
                showCustomMessage('Palette Generated!', `Generated ${palette.length} colors for ${paletteType} scheme`);
            };

            const copyColor = (color) => {
                const textarea = document.createElement('textarea');
                textarea.value = color;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showCustomMessage('Copied!', `Color ${color} copied to clipboard`);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Generate beautiful color palettes from a base color.</p>
                    <div className="mb-4">
                        <label htmlFor="base-color" className="block text-gray-700 text-sm font-semibold mb-2">Base Color</label>
                        <input type="color" id="base-color" className="w-full h-12 border border-gray-300 rounded-md" value={baseColor} onChange={(e) => setBaseColor(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="palette-type" className="block text-gray-700 text-sm font-semibold mb-2">Palette Type</label>
                        <select id="palette-type" className="w-full p-2 border border-gray-300 rounded-md" value={paletteType} onChange={(e) => setPaletteType(e.target.value)}>
                            <option value="complementary">Complementary</option>
                            <option value="triadic">Triadic</option>
                            <option value="analogous">Analogous</option>
                            <option value="monochromatic">Monochromatic</option>
                        </select>
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={generatePalette}>Generate Palette</button>
                    {generatedPalette.length > 0 && (
                        <div className="mt-6">
                            <h3 className="text-lg font-semibold mb-3">Generated Palette:</h3>
                            <div className="grid grid-cols-2 sm:grid-cols-3 gap-3">
                                {generatedPalette.map((color, index) => (
                                    <div key={index} className="text-center">
                                        <div className="w-full h-16 rounded-md border border-gray-300 cursor-pointer hover:scale-105 transition-transform" style={{backgroundColor: color}} onClick={() => copyColor(color)}></div>
                                        <p className="text-sm font-mono mt-2">{color}</p>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function LoremIpsumGenerator({ showCustomMessage }) {
            const [paragraphs, setParagraphs] = useState(3);
            const [wordsPerParagraph, setWordsPerParagraph] = useState(50);
            const [generatedText, setGeneratedText] = useState('');

            const loremWords = [
                'lorem', 'ipsum', 'dolor', 'sit', 'amet', 'consectetur', 'adipiscing', 'elit', 'sed', 'do',
                'eiusmod', 'tempor', 'incididunt', 'ut', 'labore', 'et', 'dolore', 'magna', 'aliqua', 'enim',
                'ad', 'minim', 'veniam', 'quis', 'nostrud', 'exercitation', 'ullamco', 'laboris', 'nisi',
                'aliquip', 'ex', 'ea', 'commodo', 'consequat', 'duis', 'aute', 'irure', 'in', 'reprehenderit',
                'voluptate', 'velit', 'esse', 'cillum', 'fugiat', 'nulla', 'pariatur', 'excepteur', 'sint',
                'occaecat', 'cupidatat', 'non', 'proident', 'sunt', 'culpa', 'qui', 'officia', 'deserunt',
                'mollit', 'anim', 'id', 'est', 'laborum'
            ];

            const generateLorem = () => {
                let result = [];
                for (let p = 0; p < paragraphs; p++) {
                    let paragraph = [];
                    for (let w = 0; w < wordsPerParagraph; w++) {
                        const randomWord = loremWords[Math.floor(Math.random() * loremWords.length)];
                        paragraph.push(w === 0 ? randomWord.charAt(0).toUpperCase() + randomWord.slice(1) : randomWord);
                    }
                    result.push(paragraph.join(' ') + '.');
                }
                setGeneratedText(result.join('\n\n'));
                showCustomMessage('Text Generated!', `Generated ${paragraphs} paragraphs with ${wordsPerParagraph} words each`);
            };

            const copyText = () => {
                const textarea = document.createElement('textarea');
                textarea.value = generatedText;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showCustomMessage('Copied!', 'Lorem ipsum text copied to clipboard');
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Generate placeholder text for your designs and layouts.</p>
                    <div className="mb-4">
                        <label htmlFor="paragraphs" className="block text-gray-700 text-sm font-semibold mb-2">Number of Paragraphs</label>
                        <input type="number" id="paragraphs" className="w-full p-2 border border-gray-300 rounded-md" min="1" max="10" value={paragraphs} onChange={(e) => setParagraphs(parseInt(e.target.value))} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="words" className="block text-gray-700 text-sm font-semibold mb-2">Words per Paragraph</label>
                        <input type="number" id="words" className="w-full p-2 border border-gray-300 rounded-md" min="10" max="200" value={wordsPerParagraph} onChange={(e) => setWordsPerParagraph(parseInt(e.target.value))} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={generateLorem}>Generate Lorem Ipsum</button>
                    {generatedText && (
                        <div className="mt-6">
                            <div className="flex justify-between items-center mb-3">
                                <h3 className="text-lg font-semibold">Generated Text:</h3>
                                <button className="bg-green-600 text-white py-1 px-3 rounded-md hover:bg-green-700 transition duration-200 text-sm" onClick={copyText}>Copy Text</button>
                            </div>
                            <textarea className="w-full p-3 border border-gray-300 rounded-md resize-y min-h-[200px]" readOnly value={generatedText}></textarea>
                        </div>
                    )}
                </div>
            );
        }

        function HashGenerator({ showCustomMessage }) {
            const [inputText, setInputText] = useState('');
            const [hashType, setHashType] = useState('md5');
            const [generatedHash, setGeneratedHash] = useState('');

            const generateHash = async () => {
                if (!inputText.trim()) {
                    showCustomMessage('Input Required', 'Please enter some text to hash');
                    return;
                }

                try {
                    const encoder = new TextEncoder();
                    const data = encoder.encode(inputText);
                    
                    let hashBuffer;
                    switch (hashType) {
                        case 'sha1':
                            hashBuffer = await crypto.subtle.digest('SHA-1', data);
                            break;
                        case 'sha256':
                            hashBuffer = await crypto.subtle.digest('SHA-256', data);
                            break;
                        default: // md5 - simplified implementation
                            // For MD5, we'll use a simple hash function since crypto.subtle doesn't support MD5
                            const simpleHash = Array.from(data).reduce((hash, byte) => {
                                hash = ((hash << 5) - hash) + byte;
                                return hash & hash; // Convert to 32bit integer
                            }, 0);
                            setGeneratedHash(Math.abs(simpleHash).toString(16).padStart(8, '0'));
                            showCustomMessage('Hash Generated!', `${hashType.toUpperCase()} hash generated successfully`);
                            return;
                    }
                    
                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                    setGeneratedHash(hashHex);
                    showCustomMessage('Hash Generated!', `${hashType.toUpperCase()} hash generated successfully`);
                } catch (error) {
                    showCustomMessage('Error', 'Failed to generate hash');
                }
            };

            const copyHash = () => {
                const textarea = document.createElement('textarea');
                textarea.value = generatedHash;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showCustomMessage('Copied!', 'Hash copied to clipboard');
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Generate MD5, SHA1, and SHA256 hashes from text.</p>
                    <div className="mb-4">
                        <label htmlFor="hash-input" className="block text-gray-700 text-sm font-semibold mb-2">Text to Hash</label>
                        <textarea id="hash-input" className="w-full p-3 border border-gray-300 rounded-md resize-y min-h-[100px]" placeholder="Enter text to generate hash..." value={inputText} onChange={(e) => setInputText(e.target.value)}></textarea>
                    </div>
                    <div className="mb-4">
                        <label htmlFor="hash-type" className="block text-gray-700 text-sm font-semibold mb-2">Hash Type</label>
                        <select id="hash-type" className="w-full p-2 border border-gray-300 rounded-md" value={hashType} onChange={(e) => setHashType(e.target.value)}>
                            <option value="md5">MD5</option>
                            <option value="sha1">SHA1</option>
                            <option value="sha256">SHA256</option>
                        </select>
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={generateHash}>Generate Hash</button>
                    {generatedHash && (
                        <div className="mt-6">
                            <div className="flex justify-between items-center mb-3">
                                <h3 className="text-lg font-semibold">{hashType.toUpperCase()} Hash:</h3>
                                <button className="bg-green-600 text-white py-1 px-3 rounded-md hover:bg-green-700 transition duration-200 text-sm" onClick={copyHash}>Copy Hash</button>
                            </div>
                            <div className="p-3 bg-gray-100 rounded-md font-mono text-sm break-all">{generatedHash}</div>
                        </div>
                    )}
                </div>
            );
        }

        function JSONFormatter({ showCustomMessage }) {
            const [inputJSON, setInputJSON] = useState('');
            const [formattedJSON, setFormattedJSON] = useState('');
            const [isValid, setIsValid] = useState(null);
            const [error, setError] = useState('');

            const formatJSON = () => {
                if (!inputJSON.trim()) {
                    showCustomMessage('Input Required', 'Please enter JSON to format');
                    return;
                }

                try {
                    const parsed = JSON.parse(inputJSON);
                    const formatted = JSON.stringify(parsed, null, 2);
                    setFormattedJSON(formatted);
                    setIsValid(true);
                    setError('');
                    showCustomMessage('JSON Formatted!', 'JSON has been formatted and validated successfully');
                } catch (err) {
                    setIsValid(false);
                    setError(err.message);
                    setFormattedJSON('');
                    showCustomMessage('Invalid JSON', 'Please check your JSON syntax');
                }
            };

            const minifyJSON = () => {
                if (!inputJSON.trim()) {
                    showCustomMessage('Input Required', 'Please enter JSON to minify');
                    return;
                }

                try {
                    const parsed = JSON.parse(inputJSON);
                    const minified = JSON.stringify(parsed);
                    setFormattedJSON(minified);
                    setIsValid(true);
                    setError('');
                    showCustomMessage('JSON Minified!', 'JSON has been minified successfully');
                } catch (err) {
                    setIsValid(false);
                    setError(err.message);
                    setFormattedJSON('');
                    showCustomMessage('Invalid JSON', 'Please check your JSON syntax');
                }
            };

            const copyJSON = () => {
                const textarea = document.createElement('textarea');
                textarea.value = formattedJSON;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showCustomMessage('Copied!', 'Formatted JSON copied to clipboard');
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Format, validate, and minify JSON data.</p>
                    <div className="mb-4">
                        <label htmlFor="json-input" className="block text-gray-700 text-sm font-semibold mb-2">JSON Input</label>
                        <textarea id="json-input" className="w-full p-3 border border-gray-300 rounded-md resize-y min-h-[150px] font-mono text-sm" placeholder='{"key": "value", "array": [1, 2, 3]}' value={inputJSON} onChange={(e) => setInputJSON(e.target.value)}></textarea>
                    </div>
                    <div className="flex gap-2 mb-4">
                        <button className="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={formatJSON}>Format & Validate</button>
                        <button className="flex-1 bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition duration-200 font-semibold" onClick={minifyJSON}>Minify</button>
                    </div>
                    
                    {isValid === false && (
                        <div className="mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md">
                            <p className="font-semibold">Invalid JSON:</p>
                            <p className="text-sm">{error}</p>
                        </div>
                    )}
                    
                    {formattedJSON && (
                        <div className="mt-6">
                            <div className="flex justify-between items-center mb-3">
                                <h3 className="text-lg font-semibold">Formatted JSON:</h3>
                                <button className="bg-green-600 text-white py-1 px-3 rounded-md hover:bg-green-700 transition duration-200 text-sm" onClick={copyJSON}>Copy JSON</button>
                            </div>
                            <textarea className="w-full p-3 border border-gray-300 rounded-md resize-y min-h-[200px] font-mono text-sm" readOnly value={formattedJSON}></textarea>
                        </div>
                    )}
                </div>
            );
        }


        // --- Utility Tools Components ---

        function ImageCompressor({ showCustomMessage }) {
            const [selectedFile, setSelectedFile] = useState(null);
            const [compressedImageSrc, setCompressedImageSrc] = useState('');
            const [originalSize, setOriginalSize] = useState(0);
            const [compressedSize, setCompressedSize] = useState(0);
            const [compressionQuality, setCompressionQuality] = useState(0.7);
            const [error, setError] = useState('');
            const [isProcessing, setIsProcessing] = useState(false);

            const handleFileChange = (event) => {
                const file = event.target.files[0];
                if (file) {
                    if (!file.type.startsWith('image/')) {
                        setError('Please upload an image file (e.g., JPEG, PNG).');
                        setSelectedFile(null);
                        setCompressedImageSrc('');
                        setOriginalSize(0);
                        setCompressedSize(0);
                        return;
                    }
                    setSelectedFile(file);
                    setError('');
                    setCompressedImageSrc('');
                    setOriginalSize(0);
                    setCompressedSize(0);
                }
            };

            const compressImage = () => {
                if (!selectedFile) {
                    setError('Please select an image first.');
                    return;
                }

                setIsProcessing(true);
                setError('');
                setCompressedImageSrc('');
                setOriginalSize(0);
                setCompressedSize(0);

                const reader = new FileReader();
                reader.readAsDataURL(selectedFile);
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;

                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');

                        canvas.width = img.width;
                        canvas.height = img.height;

                        ctx.drawImage(img, 0, 0);

                        const compressedDataUrl = canvas.toDataURL('image/jpeg', compressionQuality);

                        const originalBytes = selectedFile.size;
                        const compressedBytes = (compressedDataUrl.length * 0.75) - 2;

                        setOriginalSize(originalBytes);
                        setCompressedSize(compressedBytes);
                        setCompressedImageSrc(compressedDataUrl);
                        setIsProcessing(false);
                        showCustomMessage('Image Compressed!', `Original: ${formatBytes(originalBytes)}, Compressed: ${formatBytes(compressedBytes)}`);
                    };

                    img.onerror = () => {
                        setError('Could not load image. Please try another file.');
                        setIsProcessing(false);
                    };
                };

                reader.onerror = () => {
                    setError('Could not read file. Please try again.');
                    setIsProcessing(false);
                };
            };

            const formatBytes = (bytes, decimals = 2) => {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const dm = decimals < 0 ? 0 : decimals;
                const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
            };

            const handleDownload = () => {
                if (compressedImageSrc) {
                    const link = document.createElement('a');
                    link.href = compressedImageSrc;
                    link.download = `compressed_${selectedFile.name.split('.').slice(0, -1).join('.') || 'image'}.jpeg`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            };

            return (
                <div className="p-4 bg-white rounded-lg shadow-md border border-gray-100">
                    <p className="text-gray-600 text-center mb-6">Reduce image file size without significant loss in quality.</p>
                    <div className="mb-4">
                        <label htmlFor="image-upload" className="block text-gray-700 text-sm font-semibold mb-2">
                            Upload an image:
                        </label>
                        <input
                            type="file"
                            id="image-upload"
                            accept="image/*"
                            onChange={handleFileChange}
                            className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500 transition duration-200"
                        />
                    </div>

                    {selectedFile && (
                        <div className="mb-4">
                            <label htmlFor="quality-slider" className="block text-gray-700 text-sm font-semibold mb-2">
                                Compression Quality: <span className="font-bold">{(compressionQuality * 100).toFixed(0)}%</span>
                            </label>
                            <input
                                type="range"
                                id="quality-slider"
                                min="0.1"
                                max="1.0"
                                step="0.05"
                                value={compressionQuality}
                                onChange={(e) => setCompressionQuality(parseFloat(e.target.value))}
                                className="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer accent-blue-600"
                            />
                        </div>
                    )}

                    <button
                        onClick={compressImage}
                        className="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-4 rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200 ease-in-out font-semibold text-lg shadow-md"
                        disabled={!selectedFile || isProcessing}
                    >
                        {isProcessing ? (
                            <div className="flex items-center justify-center">
                                <svg className="animate-spin h-5 w-5 text-white mr-3" viewBox="0 0 24 24">
                                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                                Compressing...
                            </div>
                        ) : (
                            'Compress Image'
                        )}
                    </button>

                    {error && (
                        <div className="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md shadow-sm">
                            <p className="font-semibold">Error:</p>
                            <p>{error}</p>
                        </div>
                    )}

                    {compressedImageSrc && (
                        <div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg shadow-inner text-center">
                            <h2 className="text-xl font-semibold text-blue-800 mb-3">Compressed Image:</h2>
                            <img src={compressedImageSrc} alt="Compressed" className="max-w-full h-auto mx-auto rounded-lg border border-blue-300 shadow-md mb-4" />
                            <p className="text-gray-700 mb-2">Original Size: <span className="font-semibold">{formatBytes(originalSize)}</span></p>
                            <p className="text-gray-700 mb-4">Compressed Size: <span className="font-semibold">{formatBytes(compressedSize)}</span> (Saved: <span className="font-semibold text-green-700">{formatBytes(originalSize - compressedSize)}</span>)</p>
                            <button
                                onClick={handleDownload}
                                className="bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-200 ease-in-out font-semibold shadow-md"
                            >
                                Download Compressed Image
                            </button>
                        </div>
                    )}
                </div>
            );
        }

        function PDFMaker({ showCustomMessage }) {
            const [pdfMode, setPdfMode] = useState('text');
            const [pdfText, setPdfText] = useState('');
            const [selectedImages, setSelectedImages] = useState([]);
            const [error, setError] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);

            useEffect(() => {
                const scriptId = 'jspdf-script';
                if (!document.getElementById(scriptId)) {
                    const script = document.createElement('script');
                    script.id = scriptId;
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
                    script.async = true;
                    document.body.appendChild(script);
                    script.onerror = () => {
                        setError('Failed to load PDF generation library. Please try again.');
                    };
                }
            }, []);

            const handleImageChange = (event) => {
                const files = Array.from(event.target.files);
                const imageFiles = files.filter(file => file.type.startsWith('image/'));
                if (imageFiles.length !== files.length) {
                    setError('Only image files are allowed.');
                } else {
                    setError('');
                }
                setSelectedImages(imageFiles);
            };

            const generatePdf = async () => {
                if (typeof window.jspdf === 'undefined' || !window.jspdf.jsPDF) {
                    setError('PDF library not loaded yet. Please wait a moment and try again.');
                    return;
                }

                setIsGenerating(true);
                setError('');

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                try {
                    if (pdfMode === 'text') {
                        if (!pdfText.trim()) {
                            setError('Please enter some text to create a PDF.');
                            setIsGenerating(false);
                            return;
                        }
                        doc.setFont("helvetica");
                        doc.setFontSize(12);

                        const lines = doc.splitTextToSize(pdfText, 180);
                        let y = 15;

                        lines.forEach(line => {
                            if (y + 10 > doc.internal.pageSize.height - 10) {
                                doc.addPage();
                                y = 15;
                            }
                            doc.text(line, 15, y);
                            y += 7;
                        });
                        showCustomMessage('PDF Generated!', 'Your text has been converted to a PDF.');
                    } else if (pdfMode === 'images') {
                        if (selectedImages.length === 0) {
                            setError('Please select images to create a PDF.');
                            setIsGenerating(false);
                            return;
                        }

                        for (let i = 0; i < selectedImages.length; i++) {
                            const file = selectedImages[i];
                            const reader = new FileReader();

                            await new Promise((resolve, reject) => {
                                reader.onload = (e) => {
                                    const img = new Image();
                                    img.src = e.target.result;

                                    img.onload = () => {
                                        const imgWidth = img.width;
                                        const imgHeight = img.height;
                                        const pageWidth = doc.internal.pageSize.getWidth();
                                        const pageHeight = doc.internal.pageSize.getHeight();

                                        const margin = 10;
                                        const availableWidth = pageWidth - 2 * margin;
                                        const availableHeight = pageHeight - 2 * margin;

                                        const widthRatio = availableWidth / imgWidth;
                                        const heightRatio = availableHeight / imgHeight;
                                        const ratio = Math.min(widthRatio, heightRatio);

                                        const finalWidth = imgWidth * ratio;
                                        const finalHeight = imgHeight * ratio;

                                        const x = (pageWidth - finalWidth) / 2;
                                        const y = (pageHeight - finalHeight) / 2;

                                        if (i > 0) {
                                            doc.addPage();
                                        }
                                        doc.addImage(img.src, file.type.split('/')[1].toUpperCase(), x, y, finalWidth, finalHeight);
                                        resolve();
                                    };
                                    img.onerror = reject;
                                };
                                reader.readAsDataURL(file);
                            });
                        }
                        showCustomMessage('PDF Generated!', 'Your images have been combined into a PDF.');
                    }

                    doc.save('document.pdf');
                } catch (err) {
                    console.error('Error generating PDF:', err);
                    setError(`Failed to generate PDF: ${err.message}`);
                } finally {
                    setIsGenerating(false);
                }
            };

            return (
                <div className="p-4 bg-white rounded-lg shadow-md border border-gray-100">
                    <p className="text-gray-600 text-center mb-6">Create PDF documents from text or multiple images.</p>

                    <div className="flex justify-center space-x-4 mb-6">
                        <button
                            onClick={() => { setPdfMode('text'); setPdfText(''); setSelectedImages([]); setError(''); }}
                            className={`py-2 px-4 rounded-full font-semibold transition duration-200 ease-in-out ${
                                pdfMode === 'text'
                                    ? 'bg-blue-600 text-white shadow-md'
                                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                            }`}
                        >
                            Text to PDF
                        </button>
                        <button
                            onClick={() => { setPdfMode('images'); setPdfText(''); setSelectedImages([]); setError(''); }}
                            className={`py-2 px-4 rounded-full font-semibold transition duration-200 ease-in-out ${
                                pdfMode === 'images'
                                    ? 'bg-blue-600 text-white shadow-md'
                                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                            }`}
                        >
                            Images to PDF
                        </button>
                    </div>

                    {pdfMode === 'text' && (
                        <div className="mb-4">
                            <label htmlFor="pdf-text" className="block text-gray-700 text-sm font-semibold mb-2">
                                Enter text for your PDF:
                            </label>
                            <textarea
                                id="pdf-text"
                                className="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out resize-y min-h-[180px] shadow-sm"
                                placeholder="Type or paste the content you want in your PDF document."
                                value={pdfText}
                                onChange={(e) => setPdfText(e.target.value)}
                                rows="8"
                            ></textarea>
                        </div>
                    )}

                    {pdfMode === 'images' && (
                        <div className="mb-4">
                            <label htmlFor="image-files" className="block text-gray-700 text-sm font-semibold mb-2">
                                Upload images (JPEG, PNG):
                            </label>
                            <input
                                type="file"
                                id="image-files"
                                accept="image/*"
                                multiple
                                onChange={handleImageChange}
                                className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500 transition duration-200"
                            />
                            {selectedImages.length > 0 && (
                                <div className="mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                                    {selectedImages.map((file, index) => (
                                        <div key={index} className="relative w-full h-24 rounded-md overflow-hidden border border-gray-200 shadow-sm">
                                            <img
                                                src={URL.createObjectURL(file)}
                                                alt={`Preview ${index}`}
                                                className="w-full h-full object-cover"
                                                onLoad={() => URL.revokeObjectURL(file)}
                                            />
                                            <span className="absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1 py-0.5 rounded">
                                                {file.name}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    )}

                    <button
                        onClick={generatePdf}
                        className="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-4 rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200 ease-in-out font-semibold text-lg shadow-md"
                        disabled={isGenerating || (pdfMode === 'text' && !pdfText.trim()) || (pdfMode === 'images' && selectedImages.length === 0)}
                    >
                        {isGenerating ? (
                            <div className="flex items-center justify-center">
                                <svg className="animate-spin h-5 w-5 text-white mr-3" viewBox="0 0 24 24">
                                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                                Generating PDF...
                            </div>
                        ) : (
                            'Generate & Download PDF'
                        )}
                    </button>

                    {error && (
                        <div className="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md shadow-sm">
                            <p className="font-semibold">Error:</p>
                            <p>{error}</p>
                        </div>
                    )}
                </div>
            );
        }

        // --- Basic Utility Calculators (converted to React) ---

        function BMICalculator({ showCustomMessage }) {
            const [weight, setWeight] = useState('');
            const [height, setHeight] = useState('');
            const [result, setResult] = useState('');

            const calculateBMI = () => {
                const w = parseFloat(weight);
                const h = parseFloat(height) / 100; // convert cm to meters
                if (isNaN(w) || isNaN(h) || w <= 0 || h <= 0) {
                    setResult('<p class="text-red-600">Please enter valid positive numbers for weight and height.</p>');
                    return;
                }
                const bmi = w / (h * h);
                let category = '';
                if (bmi < 18.5) category = 'Underweight';
                else if (bmi >= 18.5 && bmi < 24.9) category = 'Normal weight';
                else if (bmi >= 25 && bmi < 29.9) category = 'Overweight';
                else category = 'Obesity';
                setResult(`<p>Your BMI: <strong class="text-blue-600">${bmi.toFixed(2)}</strong> (${category})</p>`);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Calculate your Body Mass Index.</p>
                    <div className="mb-4">
                        <label htmlFor="bmi-weight" className="block text-gray-700 text-sm font-semibold mb-2">Weight (kg)</label>
                        <input type="number" id="bmi-weight" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 70" value={weight} onChange={(e) => setWeight(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="bmi-height" className="block text-gray-700 text-sm font-semibold mb-2">Height (cm)</label>
                        <input type="number" id="bmi-height" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 175" value={height} onChange={(e) => setHeight(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateBMI}>Calculate BMI</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function AgeCalculator({ showCustomMessage }) {
            const [dob, setDob] = useState('');
            const [result, setResult] = useState('');

            const calculateAge = () => {
                if (!dob) {
                    setResult('<p class="text-red-600">Please enter your date of birth.</p>');
                    return;
                }
                const dobDate = new Date(dob);
                const today = new Date();
                let age = today.getFullYear() - dobDate.getFullYear();
                const monthDiff = today.getMonth() - dobDate.getMonth();
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dobDate.getDate())) {
                    age--;
                }
                setResult(`<p>Your Age: <strong class="text-blue-600">${age} years</strong></p>`);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Calculate your exact age from your date of birth.</p>
                    <div className="mb-4">
                        <label htmlFor="dob" className="block text-gray-700 text-sm font-semibold mb-2">Date of Birth</label>
                        <input type="date" id="dob" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" value={dob} onChange={(e) => setDob(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateAge}>Calculate Age</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function DiscountCalculator({ showCustomMessage }) {
            const [originalPrice, setOriginalPrice] = useState('');
            const [discountPercentage, setDiscountPercentage] = useState('');
            const [result, setResult] = useState('');

            const calculateDiscount = () => {
                const price = parseFloat(originalPrice);
                const discount = parseFloat(discountPercentage);
                if (isNaN(price) || isNaN(discount) || price <= 0 || discount < 0 || discount > 100) {
                    setResult('<p class="text-red-600">Please enter valid positive numbers for price and discount (0-100%).</p>');
                    return;
                }
                const discountAmount = price * (discount / 100);
                const finalPrice = price - discountAmount;
                setResult(`
                    <p>Discount Amount: <strong class="text-blue-600">${finalPrice.toFixed(2)}</strong></p>
                    <p>Final Price: <strong class="text-blue-600">${finalPrice.toFixed(2)}</strong></p>
                `);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Calculate the final price after discount.</p>
                    <div className="mb-4">
                        <label htmlFor="original-price" className="block text-gray-700 text-sm font-semibold mb-2">Original Price</label>
                        <input type="number" id="original-price" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 100" value={originalPrice} onChange={(e) => setOriginalPrice(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="discount-percentage" className="block text-gray-700 text-sm font-semibold mb-2">Discount (%)</label>
                        <input type="number" id="discount-percentage" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 15" value={discountPercentage} onChange={(e) => setDiscountPercentage(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateDiscount}>Calculate Discount</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function GSTCalculator({ showCustomMessage }) {
            const [amount, setAmount] = useState('');
            const [gstRate, setGstRate] = useState('');
            const [result, setResult] = useState('');

            const calculateGST = () => {
                const a = parseFloat(amount);
                const r = parseFloat(gstRate);
                if (isNaN(a) || isNaN(r) || a <= 0 || r < 0) {
                    setResult('<p class="text-red-600">Please enter valid positive numbers for amount and GST rate.</p>');
                    return;
                }
                const gstAmount = a * (r / 100);
                const totalAmount = a + gstAmount;
                setResult(`
                    <p>GST Amount: <strong class="text-blue-600">${gstAmount.toFixed(2)}</strong></p>
                    <p>Total Amount: <strong class="text-blue-600">${totalAmount.toFixed(2)}</strong></p>
                `);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Calculate GST amount and total price.</p>
                    <div className="mb-4">
                        <label htmlFor="gst-amount" className="block text-gray-700 text-sm font-semibold mb-2">Amount</label>
                        <input type="number" id="gst-amount" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 1000" value={amount} onChange={(e) => setAmount(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="gst-rate" className="block text-gray-700 text-sm font-semibold mb-2">GST Rate (%)</label>
                        <input type="number" id="gst-rate" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 18" value={gstRate} onChange={(e) => setGstRate(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateGST}>Calculate GST</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function SIPCalculator({ showCustomMessage }) {
            const [monthlyInvestment, setMonthlyInvestment] = useState('');
            const [expectedReturn, setExpectedReturn] = useState('');
            const [timePeriod, setTimePeriod] = useState('');
            const [result, setResult] = useState('');

            const calculateSIP = () => {
                const investment = parseFloat(monthlyInvestment);
                const annualRate = parseFloat(expectedReturn) / 100;
                const years = parseFloat(timePeriod);

                if (isNaN(investment) || isNaN(annualRate) || isNaN(years) || investment <= 0 || annualRate < 0 || years <= 0) {
                    setResult('<p class="text-red-600">Please enter valid positive numbers for all fields.</p>');
                    return;
                }

                const monthlyRate = annualRate / 12;
                const months = years * 12;

                let futureValue = 0;
                for (let i = 0; i < months; i++) {
                    futureValue += investment * Math.pow((1 + monthlyRate), (months - i));
                }
                const investedAmount = investment * months;
                const estimatedReturns = futureValue - investedAmount;

                setResult(`
                    <p>Invested Amount: <strong class="text-blue-600">${investedAmount.toFixed(2)}</strong></p>
                    <p>Estimated Returns: <strong class="text-blue-600">${estimatedReturns.toFixed(2)}</strong></p>
                    <p>Total Value: <strong class="text-blue-600">${futureValue.toFixed(2)}</strong></p>
                `);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Calculate your SIP returns.</p>
                    <div className="mb-4">
                        <label htmlFor="sip-monthly-investment" className="block text-gray-700 text-sm font-semibold mb-2">Monthly Investment</label>
                        <input type="number" id="sip-monthly-investment" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 5000" value={monthlyInvestment} onChange={(e) => setMonthlyInvestment(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="sip-expected-return" className="block text-gray-700 text-sm font-semibold mb-2">Expected Return Rate (% p.a.)</label>
                        <input type="number" id="sip-expected-return" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 12" value={expectedReturn} onChange={(e) => setExpectedReturn(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="sip-time-period" className="block text-gray-700 text-sm font-semibold mb-2">Time Period (years)</label>
                        <input type="number" id="sip-time-period" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 10" value={timePeriod} onChange={(e) => setTimePeriod(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateSIP}>Calculate SIP</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function QRCodeGenerator({ showCustomMessage }) {
            const [qrText, setQrText] = useState('');
            const canvasRef = useRef(null);
            const [qrGenerated, setQrGenerated] = useState(false);

            const generateQR = () => {
                if (!qrText.trim()) {
                    showCustomMessage('Input Required', 'Please enter text to generate QR code.');
                    setQrGenerated(false);
                    return;
                }
                QRCode.toCanvas(canvasRef.current, qrText, function (error) {
                    if (error) {
                        console.error(error);
                        showCustomMessage('Error', 'Failed to generate QR code.');
                        setQrGenerated(false);
                    } else {
                        setQrGenerated(true);
                    }
                });
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Generate QR codes from any text.</p>
                    <div className="mb-4">
                        <label htmlFor="qr-text" className="block text-gray-700 text-sm font-semibold mb-2">Text to Encode</label>
                        <input type="text" id="qr-text" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. Hello World" value={qrText} onChange={(e) => setQrText(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={generateQR}>Generate QR Code</button>
                    {qrGenerated && (
                        <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800 text-center">
                            <canvas ref={canvasRef} className="mx-auto block"></canvas>
                        </div>
                    )}
                </div>
            );
        }

        function TextToSpeech({ showCustomMessage }) {
            const [ttsText, setTtsText] = useState('');

            const playSpeech = () => {
                if (!ttsText.trim()) {
                    showCustomMessage('Input Required', 'Please enter text to convert to speech.');
                    return;
                }
                const utterance = new SpeechSynthesisUtterance(ttsText);
                speechSynthesis.speak(utterance);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Convert text into audible speech.</p>
                    <div className="mb-4">
                        <label htmlFor="tts-text" className="block text-gray-700 text-sm font-semibold mb-2">Text to Convert</label>
                        <textarea id="tts-text" className="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 resize-y min-h-[100px]" rows="4" placeholder="Enter text here..." value={ttsText} onChange={(e) => setTtsText(e.target.value)}></textarea>
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={playSpeech}>Play Speech</button>
                </div>
            );
        }

        function UnitConverter({ showCustomMessage }) {
            const [kmInput, setKmInput] = useState('');
            const [result, setResult] = useState('');

            const convertUnit = () => {
                const km = parseFloat(kmInput);
                if (isNaN(km)) {
                    setResult('<p class="text-red-600">Please enter a valid number for kilometers.</p>');
                    return;
                }
                const miles = km * 0.621371;
                setResult(`<p>${km} km is <strong class="text-blue-600">${miles.toFixed(2)} miles</strong></p>`);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Convert Kilometers to Miles.</p>
                    <div className="mb-4">
                        <label htmlFor="km-input" className="block text-gray-700 text-sm font-semibold mb-2">Kilometers</label>
                        <input type="number" id="km-input" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 100" value={kmInput} onChange={(e) => setKmInput(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={convertUnit}>Convert</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function Base64Encoder({ showCustomMessage }) {
            const [selectedFile, setSelectedFile] = useState(null);
            const [base64Output, setBase64Output] = useState('');
            const [copyBtnText, setCopyBtnText] = useState('Copy to Clipboard');

            const handleFileChange = (event) => {
                const file = event.target.files[0];
                if (file && file.type.startsWith('image/')) {
                    setSelectedFile(file);
                    setBase64Output('');
                    setCopyBtnText('Copy to Clipboard');
                } else {
                    setSelectedFile(null);
                    setBase64Output('');
                    showCustomMessage('Invalid File', 'Please select an image file.');
                }
            };

            const encodeBase64 = () => {
                if (!selectedFile) {
                    showCustomMessage('No File Selected', 'Please select an image file to encode.');
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(e) {
                    setBase64Output(e.target.result);
                    showCustomMessage('Encoded!', 'Image successfully encoded to Base64.');
                };
                reader.readAsDataURL(selectedFile);
            };

            const copyToClipboard = () => {
                if (base64Output) {
                    // Use document.execCommand('copy') for clipboard operations in iframe environments
                    const textarea = document.createElement('textarea');
                    textarea.value = base64Output;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);

                    setCopyBtnText('Copied!');
                    setTimeout(() => setCopyBtnText('Copy to Clipboard'), 2000);
                }
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Convert an image file to its Base64 string representation.</p>
                    <div className="mb-4">
                        <label htmlFor="base64-image-input" className="block text-gray-700 text-sm font-semibold mb-2">Upload Image</label>
                        <input type="file" id="base64-image-input" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" accept="image/*" onChange={handleFileChange} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={encodeBase64}>Encode to Base64</button>
                    {base64Output && (
                        <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800">
                            <textarea id="base64-output" className="w-full p-2 border border-gray-300 rounded-md shadow-sm resize-y" rows="5" readOnly value={base64Output}></textarea>
                            <button className="bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-200 font-semibold mt-3" onClick={copyToClipboard}>{copyBtnText}</button>
                        </div>
                    )}
                </div>
            );
        }

        function PasswordGenerator({ showCustomMessage }) {
            const [length, setLength] = useState(12);
            const [includeUppercase, setIncludeUppercase] = useState(true);
            const [includeLowercase, setIncludeLowercase] = useState(true);
            const [includeNumbers, setIncludeNumbers] = useState(true);
            const [includeSymbols, setIncludeSymbols] = useState(false);
            const [generatedPassword, setGeneratedPassword] = useState('');
            const [copyBtnText, setCopyBtnText] = useState('Copy to Clipboard');

            const generatePassword = () => {
                let characters = '';
                if (includeUppercase) characters += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                if (includeLowercase) characters += 'abcdefghijklmnopqrstuvwxyz';
                if (includeNumbers) characters += '0123456789';
                if (includeSymbols) characters += '!@#$%^&*()_+~`|}{[]:;?><,./-=';

                if (characters.length === 0) {
                    showCustomMessage('Selection Required', 'Please select at least one character type.');
                    setGeneratedPassword('');
                    return;
                }

                let password = '';
                for (let i = 0; i < length; i++) {
                    const randomIndex = Math.floor(Math.random() * characters.length);
                    password += characters[randomIndex];
                }
                setGeneratedPassword(password);
            };

            const copyToClipboard = () => {
                if (generatedPassword) {
                    // Use document.execCommand('copy') for clipboard operations in iframe environments
                    const input = document.createElement('input');
                    input.value = generatedPassword;
                    document.body.appendChild(input);
                    input.select();
                    document.execCommand('copy');
                    document.body.removeChild(input);

                    setCopyBtnText('Copied!');
                    setTimeout(() => setCopyBtnText('Copy to Clipboard'), 2000);
                }
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Create strong, secure passwords.</p>
                    <div className="mb-4">
                        <label htmlFor="password-length" className="block text-gray-700 text-sm font-semibold mb-2">Length</label>
                        <input type="number" id="password-length" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" min="8" max="64" value={length} onChange={(e) => setLength(parseInt(e.target.value))} />
                    </div>
                    <div className="mb-2">
                        <input type="checkbox" id="include-uppercase" className="form-checkbox h-4 w-4 text-blue-600 rounded mr-2" checked={includeUppercase} onChange={(e) => setIncludeUppercase(e.target.checked)} />
                        <label htmlFor="include-uppercase" className="text-gray-700">Include Uppercase</label>
                    </div>
                    <div className="mb-2">
                        <input type="checkbox" id="include-lowercase" className="form-checkbox h-4 w-4 text-blue-600 rounded mr-2" checked={includeLowercase} onChange={(e) => setIncludeLowercase(e.target.checked)} />
                        <label htmlFor="include-lowercase" className="text-gray-700">Include Lowercase</label>
                    </div>
                    <div className="mb-2">
                        <input type="checkbox" id="include-numbers" className="form-checkbox h-4 w-4 text-blue-600 rounded mr-2" checked={includeNumbers} onChange={(e) => setIncludeNumbers(e.target.checked)} />
                        <label htmlFor="include-numbers" className="text-gray-700">Include Numbers</label>
                    </div>
                    <div className="mb-4">
                        <input type="checkbox" id="include-symbols" className="form-checkbox h-4 w-4 text-blue-600 rounded mr-2" checked={includeSymbols} onChange={(e) => setIncludeSymbols(e.target.checked)} />
                        <label htmlFor="include-symbols" className="text-gray-700">Include Symbols</label>
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={generatePassword}>Generate Password</button>
                    {generatedPassword && (
                        <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800">
                            <input type="text" id="generated-password-output" className="w-full p-2 border border-gray-300 rounded-md shadow-sm" readOnly value={generatedPassword} />
                            <button className="bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-200 font-semibold mt-3" onClick={copyToClipboard}>{copyBtnText}</button>
                        </div>
                    )}
                </div>
            );
        }

        function CurrencyConverter({ showCustomMessage }) {
            const [amount, setAmount] = useState('');
            const [fromCurrency, setFromCurrency] = useState('USD');
            const [toCurrency, setToCurrency] = useState('EUR');
            const [result, setResult] = useState('');

            const rates = {
                USD: { EUR: 0.85, GBP: 0.73, JPY: 110.5, INR: 75.2, CAD: 1.25, AUD: 1.35, CNY: 6.4 },
                EUR: { USD: 1.18, GBP: 0.86, JPY: 130.2, INR: 88.5, CAD: 1.47, AUD: 1.59, CNY: 7.5 },
                GBP: { USD: 1.37, EUR: 1.16, JPY: 151.3, INR: 103.1, CAD: 1.7, AUD: 1.84, CNY: 8.7 },
                JPY: { USD: 0.009, EUR: 0.0077, GBP: 0.0066, INR: 0.68, CAD: 0.011, AUD: 0.012, CNY: 0.058 },
                INR: { USD: 0.013, EUR: 0.011, GBP: 0.0097, JPY: 1.47, CAD: 0.016, AUD: 0.018, CNY: 0.085 },
                CAD: { USD: 0.8, EUR: 0.68, GBP: 0.58, JPY: 88.4, INR: 60.1, AUD: 1.08, CNY: 5.1 },
                AUD: { USD: 0.74, EUR: 0.63, GBP: 0.54, JPY: 81.9, INR: 55.6, CAD: 0.92, CNY: 4.7 },
                CNY: { USD: 0.15, EUR: 0.13, GBP: 0.11, JPY: 17.2, INR: 11.7, CAD: 0.2, AUD: 0.21 }
            };

            const convertCurrency = () => {
                const amt = parseFloat(amount);
                if (isNaN(amt) || amt <= 0) {
                    setResult('<p class="text-red-600">Please enter a valid positive amount.</p>');
                    return;
                }
                if (fromCurrency === toCurrency) {
                    setResult(`<p>Same currencies selected: <strong class="text-blue-600">${amt.toFixed(2)} ${fromCurrency}</strong></p>`);
                    return;
                }

                let convertedAmount;
                if (rates[fromCurrency] && rates[fromCurrency][toCurrency]) {
                    convertedAmount = amt * rates[fromCurrency][toCurrency];
                } else if (rates[toCurrency] && rates[toCurrency][fromCurrency]) {
                    convertedAmount = amt / rates[toCurrency][fromCurrency];
                } else {
                    setResult(`<p class="text-red-600">Conversion rate not available for ${fromCurrency} to ${toCurrency}.</p>`);
                    return;
                }
                setResult(`<p>${amt.toFixed(2)} ${fromCurrency} = <strong class="text-blue-600">${convertedAmount.toFixed(2)} ${toCurrency}</strong></p>`);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Convert amounts between different currencies (using approximate rates).</p>
                    <div className="mb-4">
                        <label htmlFor="convert-amount" className="block text-gray-700 text-sm font-semibold mb-2">Amount</label>
                        <input type="number" id="convert-amount" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 100" value={amount} onChange={(e) => setAmount(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="convert-from" className="block text-gray-700 text-sm font-semibold mb-2">From Currency</label>
                        <select id="convert-from" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" value={fromCurrency} onChange={(e) => setFromCurrency(e.target.value)}>
                            {Object.keys(rates).map(currency => <option key={currency} value={currency}>{currency}</option>)}
                        </select>
                    </div>
                    <div className="mb-4">
                        <label htmlFor="convert-to" className="block text-gray-700 text-sm font-semibold mb-2">To Currency</label>
                        <select id="convert-to" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" value={toCurrency} onChange={(e) => setToCurrency(e.target.value)}>
                            {Object.keys(rates).map(currency => <option key={currency} value={currency}>{currency}</option>)}
                        </select>
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={convertCurrency}>Convert</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function ElectricityBillCalculator({ showCustomMessage }) {
            const [unitsConsumed, setUnitsConsumed] = useState('');
            const [costPerUnit, setCostPerUnit] = useState('');
            const [result, setResult] = useState('');

            const calculateBill = () => {
                const units = parseFloat(unitsConsumed);
                const cost = parseFloat(costPerUnit);
                if (isNaN(units) || isNaN(cost) || units < 0 || cost < 0) {
                    setResult('<p class="text-red-600">Please enter valid non-negative numbers for units and cost.</p>');
                    return;
                }
                const totalBill = units * cost;
                setResult(`<p>Estimated Bill: <strong class="text-blue-600">${totalBill.toFixed(2)}</strong></p>`);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Calculate your estimated electricity bill.</p>
                    <div className="mb-4">
                        <label htmlFor="units-consumed" className="block text-gray-700 text-sm font-semibold mb-2">Units Consumed</label>
                        <input type="number" id="units-consumed" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 200" value={unitsConsumed} onChange={(e) => setUnitsConsumed(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="cost-per-unit" className="block text-gray-700 text-sm font-semibold mb-2">Cost per Unit</label>
                        <input type="number" id="cost-per-unit" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 7.5" value={costPerUnit} onChange={(e) => setCostPerUnit(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateBill}>Calculate Bill</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function WaterIntakeCalculator({ showCustomMessage }) {
            const [weight, setWeight] = useState('');
            const [result, setResult] = useState('');

            const calculateIntake = () => {
                const w = parseFloat(weight);
                if (isNaN(w) || w <= 0) {
                    setResult('<p class="text-red-600">Please enter a valid positive weight.</p>');
                    return;
                }
                const intakeMl = w * 33; // General recommendation: ~33ml per kg
                const intakeLiters = intakeMl / 1000;
                setResult(`<p>Recommended daily water intake: <strong class="text-blue-600">${intakeLiters.toFixed(2)} liters</strong> (${intakeMl.toFixed(0)} ml)</p>`);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Calculate your recommended daily water intake.</p>
                    <div className="mb-4">
                        <label htmlFor="water-weight" className="block text-gray-700 text-sm font-semibold mb-2">Your Weight (kg)</label>
                        <input type="number" id="water-weight" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 70" value={weight} onChange={(e) => setWeight(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateIntake}>Calculate Intake</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function SleepCalculator({ showCustomMessage }) {
            const [bedtime, setBedtime] = useState('');
            const [result, setResult] = useState('');

            const calculateWakeUpTime = () => {
                if (!bedtime) {
                    setResult('<p class="text-red-600">Please enter your planned bedtime.</p>');
                    return;
                }
                const [hours, minutes] = bedtime.split(':').map(Number);
                const bedtimeDate = new Date();
                bedtimeDate.setHours(hours, minutes, 0, 0);

                const sleepCycles = [4, 5, 6]; // Common sleep cycles
                let resultHtml = '<h4 class="font-semibold text-lg mb-2">Optimal Wake Up Times:</h4><ul class="list-disc list-inside space-y-1">';

                sleepCycles.forEach(cycles => {
                    const wakeUpTime = new Date(bedtimeDate.getTime() + (cycles * 90 + 15) * 60 * 1000); // 90 mins per cycle + 15 mins to fall asleep
                    resultHtml += `<li>For ${cycles} cycles: <strong class="text-blue-600">${wakeUpTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</strong></li>`;
                });
                resultHtml += '</ul><p class="text-sm text-gray-600 mt-2">Aim to wake up at the end of a sleep cycle to feel refreshed.</p>';
                setResult(resultHtml);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Find optimal wake-up times based on sleep cycles.</p>
                    <div className="mb-4">
                        <label htmlFor="bedtime-input" className="block text-gray-700 text-sm font-semibold mb-2">When do you plan to sleep?</label>
                        <input type="time" id="bedtime-input" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" value={bedtime} onChange={(e) => setBedtime(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateWakeUpTime}>Calculate Wake Up Time</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        function TipCalculator({ showCustomMessage }) {
            const [billAmount, setBillAmount] = useState('');
            const [tipPercentage, setTipPercentage] = useState('');
            const [result, setResult] = useState('');

            const calculateTip = () => {
                const bill = parseFloat(billAmount);
                const tipPct = parseFloat(tipPercentage);
                if (isNaN(bill) || isNaN(tipPct) || bill < 0 || tipPct < 0) {
                    setResult('<p class="text-red-600">Please enter valid non-negative numbers for bill and tip percentage.</p>');
                    return;
                }
                const tipAmount = bill * (tipPct / 100);
                const totalAmount = bill + tipAmount;
                setResult(`
                    <p>Tip Amount: <strong class="text-blue-600">${tipAmount.toFixed(2)}</strong></p>
                    <p>Total Bill: <strong class="text-blue-600">${totalAmount.toFixed(2)}</strong></p>
                `);
            };

            return (
                <div className="p-4 bg-white rounded-lg">
                    <p className="text-gray-600 text-center mb-6">Calculate tips easily.</p>
                    <div className="mb-4">
                        <label htmlFor="bill-amount" className="block text-gray-700 text-sm font-semibold mb-2">Bill Amount</label>
                        <input type="number" id="bill-amount" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 50" value={billAmount} onChange={(e) => setBillAmount(e.target.value)} />
                    </div>
                    <div className="mb-4">
                        <label htmlFor="tip-percentage" className="block text-gray-700 text-sm font-semibold mb-2">Tip Percentage (%)</label>
                        <input type="number" id="tip-percentage" className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500" placeholder="e.g. 15" value={tipPercentage} onChange={(e) => setTipPercentage(e.target.value)} />
                    </div>
                    <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" onClick={calculateTip}>Calculate Tip</button>
                    <div className="mt-4 p-3 bg-blue-50 rounded-md font-semibold text-gray-800" dangerouslySetInnerHTML={{ __html: result }}></div>
                </div>
            );
        }

        // --- Placeholder Tool Components (with custom messages) ---
        function PDFToolsPlaceholder({ showCustomMessage }) {
            return (
                <div className="p-4 bg-white rounded-lg text-center">
                    <p className="text-gray-600 mb-4">This section will contain options for merging, splitting, compressing, and converting PDF files.</p>
                    <button onClick={() => showCustomMessage('Coming Soon!', 'PDF Tools functionality is not yet implemented. Stay tuned for updates!')} className="bg-gray-300 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-400 transition duration-200 font-semibold">
                        Learn More
                    </button>
                </div>
            );
        }

        function VideoConverterPlaceholder({ showCustomMessage }) {
            return (
                <div className="p-4 bg-white rounded-lg text-center">
                    <p className="text-gray-600 mb-4">Upload a video to convert it to MP3 or compress its size.</p>
                    <button onClick={() => showCustomMessage('Coming Soon!', 'Video Converter functionality is not yet implemented. Stay tuned for updates!')} className="bg-gray-300 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-400 transition duration-200 font-semibold">
                        Learn More
                    </button>
                </div>
            );
        }

        function ImageToTextOCRPlaceholder({ showCustomMessage }) {
            return (
                <div className="p-4 bg-white rounded-lg text-center">
                    <p className="text-gray-600 mb-4">Upload an image to extract text from it using OCR.</p>
                    <button onClick={() => showCustomMessage('Coming Soon!', 'Image to Text (OCR) functionality is not yet implemented. Stay tuned for updates!')} className="bg-gray-300 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-400 transition duration-200 font-semibold">
                        Learn More
                    </button>
                </div>
            );
        }

        function FileConverterPlaceholder({ showCustomMessage }) {
            return (
                <div className="p-4 bg-white rounded-lg text-center">
                    <p className="text-gray-600 mb-4">Convert various document, image, and video files.</p>
                    <button onClick={() => showCustomMessage('Coming Soon!', 'File Converter functionality is not yet implemented. Stay tuned for updates!')} className="bg-gray-300 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-400 transition duration-200 font-semibold">
                        Learn More
                    </button>
                </div>
            );
        }

        // --- Modals for Expense Tracker ---

        function TransactionModal({ isOpen, onClose, transactionType, setTransactionType, saveTransactionsToLocal, showCustomMessage }) {
            const [amount, setAmount] = useState('');
            const [category, setCategory] = useState('');
            const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
            const [description, setDescription] = useState('');

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!amount || !category || !date) {
                    showCustomMessage('Input Error', 'Please fill in all required fields (Amount, Category, Date).');
                    return;
                }

                const newTransaction = {
                    type: transactionType,
                    amount: parseFloat(amount),
                    category,
                    date,
                    description: description || `${category} ${transactionType}`
                };

                await saveTransactionsToLocal(newTransaction);
                showCustomMessage('Success!', `Transaction added: ${transactionType.charAt(0).toUpperCase() + transactionType.slice(1)} of ${parseFloat(amount).toFixed(2)}.`);
                onClose();
                // Reset form
                setAmount('');
                setCategory('');
                setDate(new Date().toISOString().split('T')[0]);
                setDescription('');
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] p-4">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-md p-6">
                        <div className="flex justify-between items-center mb-4 border-b pb-3">
                            <h3 className="text-2xl font-bold text-gray-800">üí∏ Add Transaction</h3>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-800 text-3xl font-light leading-none">√ó</button>
                        </div>
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div className="flex border border-gray-300 rounded-lg overflow-hidden">
                                <button
                                    type="button"
                                    onClick={() => setTransactionType('expense')}
                                    className={`flex-1 py-2 px-4 font-semibold transition-all duration-200 ${transactionType === 'expense' ? 'bg-primary text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}
                                >
                                    Expense ‚ûñ
                                </button>
                                <button
                                    type="button"
                                    onClick={() => setTransactionType('income')}
                                    className={`flex-1 py-2 px-4 font-semibold transition-all duration-200 ${transactionType === 'income' ? 'bg-primary text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}
                                >
                                    Income ‚ûï
                                </button>
                            </div>
                            <div className="form-group">
                                <label htmlFor="amount" className="block text-gray-700 text-sm font-semibold mb-1">üí∞ Amount</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="amount" placeholder="0.00" required step="0.01" type="number" value={amount} onChange={(e) => setAmount(e.target.value)} />
                            </div>
                            <div className="form-group">
                                <label htmlFor="category" className="block text-gray-700 text-sm font-semibold mb-1">üè∑Ô∏è Category</label>
                                <select className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="category" required value={category} onChange={(e) => setCategory(e.target.value)}>
                                    <option value="">Select Category</option>
                                    <option value="food">üçî Food</option>
                                    <option value="transport">üöó Transport</option>
                                    <option value="shopping">üõçÔ∏è Shopping</option>
                                    <option value="housing">üè† Housing</option>
                                    <option value="entertainment">üé¨ Entertainment</option>
                                    <option value="salary">üíº Salary</option>
                                    <option value="other">‚ú® Other</option>
                                </select>
                            </div>
                            <div className="form-group">
                                <label htmlFor="date" className="block text-gray-700 text-sm font-semibold mb-1">üìÖ Date</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="date" required type="date" value={date} onChange={(e) => setDate(e.target.value)} />
                            </div>
                            <div className="form-group">
                                <label htmlFor="description" className="block text-gray-700 text-sm font-semibold mb-1">üìù Description (Optional)</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="description" placeholder="Add a note" type="text" value={description} onChange={(e) => setDescription(e.target.value)} />
                            </div>
                            <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" type="submit">üíæ Save Transaction</button>
                        </form>
                    </div>
                </div>
            );
        }

        function BudgetModal({ isOpen, onClose, saveBudgetsToLocal, showCustomMessage }) {
            const [category, setCategory] = useState('');
            const [amount, setAmount] = useState('');

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!category || !amount) {
                    showCustomMessage('Input Error', 'Please select a category and enter an amount.');
                    return;
                }
                await saveBudgetsToLocal({ category, budget: parseFloat(amount) });
                showCustomMessage('Success!', `Budget for ${category} set to ${parseFloat(amount).toFixed(2)}.`);
                onClose();
                setCategory('');
                setAmount('');
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] p-4">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-md p-6">
                        <div className="flex justify-between items-center mb-4 border-b pb-3">
                            <h3 className="text-2xl font-bold text-gray-800">üí∞ Set Budget</h3>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-800 text-3xl font-light leading-none">√ó</button>
                        </div>
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div className="form-group">
                                <label htmlFor="budget-category" className="block text-gray-700 text-sm font-semibold mb-1">üè∑Ô∏è Category</label>
                                <select className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="budget-category" required value={category} onChange={(e) => setCategory(e.target.value)}>
                                    <option value="">Select Category</option>
                                    <option value="food">üçî Food</option>
                                    <option value="transport">üöó Transport</option>
                                    <option value="shopping">üõçÔ∏è Shopping</option>
                                    <option value="housing">üè† Housing</option>
                                    <option value="entertainment">üé¨ Entertainment</option>
                                </select>
                            </div>
                            <div className="form-group">
                                <label htmlFor="budget-amount" className="block text-gray-700 text-sm font-semibold mb-1">üí∞ Budget Amount</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="budget-amount" placeholder="0.00" required step="0.01" type="number" value={amount} onChange={(e) => setAmount(e.target.value)} />
                            </div>
                            <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" type="submit">üíæ Save Budget</button>
                        </form>
                    </div>
                </div>
            );
        }

        function GroceryModal({ isOpen, onClose, saveGroceryToLocal, showCustomMessage }) {
            const [name, setName] = useState('');
            const [quantity, setQuantity] = useState('');

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!name.trim()) {
                    showCustomMessage('Input Error', 'Please enter an item name.');
                    return;
                }
                await saveGroceryToLocal({ name, quantity: quantity || '1', completed: false });
                showCustomMessage('Success!', `Grocery item "${name}" added.`);
                onClose();
                setName('');
                setQuantity('');
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] p-4">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-md p-6">
                        <div className="flex justify-between items-center mb-4 border-b pb-3">
                            <h3 className="text-2xl font-bold text-gray-800">üõí Add Grocery Item</h3>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-800 text-3xl font-light leading-none">√ó</button>
                        </div>
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div className="form-group">
                                <label htmlFor="grocery-name" className="block text-gray-700 text-sm font-semibold mb-1">üìù Item Name</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="grocery-name" placeholder="e.g. Milk" required type="text" value={name} onChange={(e) => setName(e.target.value)} />
                            </div>
                            <div className="form-group">
                                <label htmlFor="grocery-quantity" className="block text-gray-700 text-sm font-semibold mb-1">üî¢ Quantity</label>
                                <input className="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" id="grocery-quantity" placeholder="e.g. 1 liter" type="text" value={quantity} onChange={(e) => setQuantity(e.target.value)} />
                            </div>
                            <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 font-semibold" type="submit">üíæ Add Item</button>
                        </form>
                    </div>
                </div>
            );
        }

        function ConfirmationModal({ isOpen, onClose, onConfirm }) {
            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1001] p-4">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-sm p-6 text-center">
                        <h3 className="text-2xl font-bold text-gray-800 mb-4">üóëÔ∏è Delete Transaction</h3>
                        <p className="text-gray-700 mb-6">Are you sure you want to delete this transaction?</p>
                        <div className="flex justify-center gap-4">
                            <button onClick={onClose} className="bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 transition duration-200 font-semibold">‚ùå Cancel</button>
                            <button onClick={onConfirm} className="bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition duration-200 font-semibold">‚úÖ Delete</button>
                        </div>
                    </div>
                </div>
            );
        }

        // Mount the React App
        const root = createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
	<script type='text/javascript' src='//pl27287267.profitableratecpm.com/4c/3d/4e/4c3d4e90663057ad254f0038a3d69b13.js'></script>
</body>
</html>
